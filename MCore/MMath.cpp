#include "MMath.h"
#include "MFloat2.h"
#include "MArray.h"

#ifdef _MSC_VER
#pragma warning(push)
#pragma warning(disable : 4305)
#endif

namespace Rad {

	const float Math::SIN_TABLE[TRI_TABLE_SIZE + 1] = {
		0.000000,0.003068,0.006136,0.009204,0.012272,0.015339,0.018407,0.021474,
		0.024541,0.027608,0.030675,0.033741,0.036807,0.039873,0.042938,0.046003,
		0.049068,0.052132,0.055195,0.058258,0.061321,0.064383,0.067444,0.070505,
		0.073565,0.076624,0.079682,0.082740,0.085797,0.088854,0.091909,0.094963,
		0.098017,0.101070,0.104122,0.107172,0.110222,0.113271,0.116319,0.119365,
		0.122411,0.125455,0.128498,0.131540,0.134581,0.137620,0.140658,0.143695,
		0.146730,0.149765,0.152797,0.155828,0.158858,0.161886,0.164913,0.167938,
		0.170962,0.173984,0.177004,0.180023,0.183040,0.186055,0.189069,0.192080,
		0.195090,0.198098,0.201105,0.204109,0.207111,0.210112,0.213110,0.216107,
		0.219101,0.222094,0.225084,0.228072,0.231058,0.234042,0.237024,0.240003,
		0.242980,0.245955,0.248928,0.251898,0.254866,0.257831,0.260794,0.263755,
		0.266713,0.269668,0.272621,0.275572,0.278520,0.281465,0.284408,0.287347,
		0.290285,0.293219,0.296151,0.299080,0.302006,0.304929,0.307850,0.310767,
		0.313682,0.316593,0.319502,0.322408,0.325310,0.328210,0.331106,0.334000,
		0.336890,0.339777,0.342661,0.345541,0.348419,0.351293,0.354164,0.357031,
		0.359895,0.362756,0.365613,0.368467,0.371317,0.374164,0.377007,0.379847,
		0.382683,0.385516,0.388345,0.391170,0.393992,0.396810,0.399624,0.402435,
		0.405241,0.408044,0.410843,0.413638,0.416430,0.419217,0.422000,0.424780,
		0.427555,0.430326,0.433094,0.435857,0.438616,0.441371,0.444122,0.446869,
		0.449611,0.452350,0.455084,0.457813,0.460539,0.463260,0.465977,0.468689,
		0.471397,0.474100,0.476799,0.479494,0.482184,0.484869,0.487550,0.490227,
		0.492898,0.495565,0.498228,0.500885,0.503538,0.506187,0.508830,0.511469,
		0.514103,0.516732,0.519356,0.521975,0.524590,0.527199,0.529804,0.532403,
		0.534998,0.537587,0.540172,0.542751,0.545325,0.547894,0.550458,0.553017,
		0.555570,0.558119,0.560662,0.563199,0.565732,0.568259,0.570781,0.573297,
		0.575808,0.578314,0.580814,0.583309,0.585798,0.588282,0.590760,0.593232,
		0.595699,0.598161,0.600617,0.603067,0.605511,0.607950,0.610383,0.612810,
		0.615232,0.617647,0.620057,0.622461,0.624860,0.627252,0.629638,0.632019,
		0.634393,0.636762,0.639124,0.641481,0.643832,0.646176,0.648514,0.650847,
		0.653173,0.655493,0.657807,0.660114,0.662416,0.664711,0.667000,0.669283,
		0.671559,0.673829,0.676093,0.678350,0.680601,0.682846,0.685084,0.687315,
		0.689541,0.691759,0.693971,0.696177,0.698376,0.700569,0.702755,0.704934,
		0.707107,0.709273,0.711432,0.713585,0.715731,0.717870,0.720003,0.722128,
		0.724247,0.726359,0.728464,0.730563,0.732654,0.734739,0.736817,0.738887,
		0.740951,0.743008,0.745058,0.747101,0.749136,0.751165,0.753187,0.755201,
		0.757209,0.759209,0.761202,0.763188,0.765167,0.767139,0.769103,0.771061,
		0.773010,0.774953,0.776888,0.778817,0.780737,0.782651,0.784557,0.786455,
		0.788346,0.790230,0.792107,0.793975,0.795837,0.797691,0.799537,0.801376,
		0.803208,0.805031,0.806848,0.808656,0.810457,0.812251,0.814036,0.815814,
		0.817585,0.819348,0.821103,0.822850,0.824589,0.826321,0.828045,0.829761,
		0.831470,0.833170,0.834863,0.836548,0.838225,0.839894,0.841555,0.843208,
		0.844854,0.846491,0.848120,0.849742,0.851355,0.852961,0.854558,0.856147,
		0.857729,0.859302,0.860867,0.862424,0.863973,0.865514,0.867046,0.868571,
		0.870087,0.871595,0.873095,0.874587,0.876070,0.877545,0.879012,0.880471,
		0.881921,0.883363,0.884797,0.886223,0.887640,0.889048,0.890449,0.891841,
		0.893224,0.894599,0.895966,0.897325,0.898674,0.900016,0.901349,0.902673,
		0.903989,0.905297,0.906596,0.907886,0.909168,0.910441,0.911706,0.912962,
		0.914210,0.915449,0.916679,0.917901,0.919114,0.920318,0.921514,0.922701,
		0.923880,0.925049,0.926210,0.927363,0.928506,0.929641,0.930767,0.931884,
		0.932993,0.934093,0.935184,0.936266,0.937339,0.938404,0.939459,0.940506,
		0.941544,0.942573,0.943593,0.944605,0.945607,0.946601,0.947586,0.948561,
		0.949528,0.950486,0.951435,0.952375,0.953306,0.954228,0.955141,0.956045,
		0.956940,0.957826,0.958704,0.959572,0.960431,0.961281,0.962121,0.962953,
		0.963776,0.964590,0.965394,0.966190,0.966976,0.967754,0.968522,0.969281,
		0.970031,0.970772,0.971504,0.972227,0.972940,0.973644,0.974339,0.975025,
		0.975702,0.976370,0.977028,0.977677,0.978317,0.978948,0.979570,0.980182,
		0.980785,0.981379,0.981964,0.982539,0.983105,0.983662,0.984210,0.984748,
		0.985278,0.985798,0.986308,0.986809,0.987301,0.987784,0.988258,0.988722,
		0.989177,0.989622,0.990058,0.990485,0.990903,0.991311,0.991710,0.992099,
		0.992480,0.992850,0.993212,0.993564,0.993907,0.994240,0.994565,0.994879,
		0.995185,0.995481,0.995767,0.996045,0.996313,0.996571,0.996820,0.997060,
		0.997290,0.997511,0.997723,0.997925,0.998118,0.998302,0.998476,0.998640,
		0.998795,0.998941,0.999078,0.999205,0.999322,0.999431,0.999529,0.999619,
		0.999699,0.999769,0.999831,0.999882,0.999925,0.999958,0.999981,0.999995,
		1.000000,0.999995,0.999981,0.999958,0.999925,0.999882,0.999831,0.999769,
		0.999699,0.999619,0.999529,0.999431,0.999322,0.999205,0.999078,0.998941,
		0.998795,0.998640,0.998476,0.998302,0.998118,0.997925,0.997723,0.997511,
		0.997290,0.997060,0.996820,0.996571,0.996313,0.996045,0.995767,0.995481,
		0.995185,0.994879,0.994565,0.994240,0.993907,0.993564,0.993212,0.992850,
		0.992480,0.992099,0.991710,0.991311,0.990903,0.990485,0.990058,0.989622,
		0.989177,0.988722,0.988258,0.987784,0.987301,0.986809,0.986308,0.985798,
		0.985278,0.984748,0.984210,0.983662,0.983105,0.982539,0.981964,0.981379,
		0.980785,0.980182,0.979570,0.978948,0.978317,0.977677,0.977028,0.976370,
		0.975702,0.975025,0.974339,0.973644,0.972940,0.972227,0.971504,0.970772,
		0.970031,0.969281,0.968522,0.967754,0.966976,0.966190,0.965394,0.964590,
		0.963776,0.962953,0.962121,0.961280,0.960431,0.959571,0.958703,0.957826,
		0.956940,0.956045,0.955141,0.954228,0.953306,0.952375,0.951435,0.950486,
		0.949528,0.948561,0.947586,0.946601,0.945607,0.944605,0.943593,0.942573,
		0.941544,0.940506,0.939459,0.938403,0.937339,0.936266,0.935184,0.934093,
		0.932993,0.931884,0.930767,0.929641,0.928506,0.927363,0.926210,0.925049,
		0.923880,0.922701,0.921514,0.920318,0.919114,0.917901,0.916679,0.915449,
		0.914210,0.912962,0.911706,0.910441,0.909168,0.907886,0.906596,0.905297,
		0.903989,0.902673,0.901349,0.900016,0.898674,0.897325,0.895966,0.894599,
		0.893224,0.891841,0.890449,0.889048,0.887640,0.886222,0.884797,0.883363,
		0.881921,0.880471,0.879012,0.877545,0.876070,0.874587,0.873095,0.871595,
		0.870087,0.868571,0.867046,0.865514,0.863973,0.862424,0.860867,0.859302,
		0.857729,0.856147,0.854558,0.852961,0.851355,0.849742,0.848120,0.846491,
		0.844854,0.843208,0.841555,0.839894,0.838225,0.836548,0.834863,0.833170,
		0.831470,0.829761,0.828045,0.826321,0.824589,0.822850,0.821102,0.819348,
		0.817585,0.815814,0.814036,0.812251,0.810457,0.808656,0.806848,0.805031,
		0.803208,0.801376,0.799537,0.797691,0.795837,0.793975,0.792107,0.790230,
		0.788346,0.786455,0.784557,0.782650,0.780737,0.778816,0.776888,0.774953,
		0.773010,0.771061,0.769103,0.767139,0.765167,0.763188,0.761202,0.759209,
		0.757209,0.755201,0.753187,0.751165,0.749136,0.747101,0.745058,0.743008,
		0.740951,0.738887,0.736816,0.734739,0.732654,0.730563,0.728464,0.726359,
		0.724247,0.722128,0.720003,0.717870,0.715731,0.713585,0.711432,0.709273,
		0.707107,0.704934,0.702755,0.700569,0.698376,0.696177,0.693971,0.691759,
		0.689541,0.687315,0.685084,0.682845,0.680601,0.678350,0.676093,0.673829,
		0.671559,0.669282,0.667000,0.664711,0.662416,0.660114,0.657807,0.655493,
		0.653173,0.650847,0.648514,0.646176,0.643832,0.641481,0.639124,0.636762,
		0.634393,0.632019,0.629638,0.627252,0.624859,0.622461,0.620057,0.617647,
		0.615232,0.612810,0.610383,0.607950,0.605511,0.603066,0.600616,0.598161,
		0.595699,0.593232,0.590760,0.588282,0.585798,0.583309,0.580814,0.578314,
		0.575808,0.573297,0.570781,0.568259,0.565732,0.563199,0.560661,0.558118,
		0.555570,0.553017,0.550458,0.547894,0.545325,0.542751,0.540171,0.537587,
		0.534997,0.532403,0.529803,0.527199,0.524590,0.521975,0.519356,0.516732,
		0.514103,0.511469,0.508830,0.506187,0.503538,0.500885,0.498228,0.495565,
		0.492898,0.490226,0.487550,0.484869,0.482184,0.479494,0.476799,0.474100,
		0.471397,0.468689,0.465976,0.463260,0.460539,0.457813,0.455083,0.452349,
		0.449611,0.446869,0.444122,0.441371,0.438616,0.435857,0.433094,0.430326,
		0.427555,0.424780,0.422000,0.419217,0.416429,0.413638,0.410843,0.408044,
		0.405241,0.402435,0.399624,0.396810,0.393992,0.391170,0.388345,0.385516,
		0.382683,0.379847,0.377007,0.374164,0.371317,0.368467,0.365613,0.362756,
		0.359895,0.357031,0.354163,0.351293,0.348419,0.345541,0.342661,0.339777,
		0.336890,0.334000,0.331106,0.328210,0.325310,0.322408,0.319502,0.316593,
		0.313682,0.310767,0.307849,0.304929,0.302006,0.299080,0.296151,0.293219,
		0.290285,0.287347,0.284408,0.281465,0.278520,0.275572,0.272621,0.269668,
		0.266713,0.263755,0.260794,0.257831,0.254866,0.251898,0.248928,0.245955,
		0.242980,0.240003,0.237023,0.234042,0.231058,0.228072,0.225084,0.222093,
		0.219101,0.216107,0.213110,0.210112,0.207111,0.204109,0.201105,0.198098,
		0.195090,0.192080,0.189069,0.186055,0.183040,0.180023,0.177004,0.173984,
		0.170962,0.167938,0.164913,0.161886,0.158858,0.155828,0.152797,0.149764,
		0.146730,0.143695,0.140658,0.137620,0.134581,0.131540,0.128498,0.125455,
		0.122411,0.119365,0.116319,0.113271,0.110222,0.107172,0.104122,0.101070,
		0.098017,0.094963,0.091909,0.088853,0.085797,0.082740,0.079682,0.076624,
		0.073564,0.070504,0.067444,0.064382,0.061321,0.058258,0.055195,0.052132,
		0.049067,0.046003,0.042938,0.039873,0.036807,0.033741,0.030675,0.027608,
		0.024541,0.021474,0.018407,0.015339,0.012271,0.009204,0.006136,0.003068,
		-0.000000,-0.003068,-0.006136,-0.009204,-0.012272,-0.015339,-0.018407,-0.021474,
		-0.024541,-0.027608,-0.030675,-0.033741,-0.036807,-0.039873,-0.042938,-0.046003,
		-0.049068,-0.052132,-0.055195,-0.058258,-0.061321,-0.064383,-0.067444,-0.070505,
		-0.073565,-0.076624,-0.079683,-0.082740,-0.085797,-0.088854,-0.091909,-0.094964,
		-0.098017,-0.101070,-0.104122,-0.107173,-0.110222,-0.113271,-0.116319,-0.119365,
		-0.122411,-0.125455,-0.128498,-0.131540,-0.134581,-0.137620,-0.140658,-0.143695,
		-0.146730,-0.149765,-0.152797,-0.155828,-0.158858,-0.161886,-0.164913,-0.167938,
		-0.170962,-0.173984,-0.177004,-0.180023,-0.183040,-0.186055,-0.189069,-0.192081,
		-0.195090,-0.198099,-0.201105,-0.204109,-0.207112,-0.210112,-0.213110,-0.216107,
		-0.219101,-0.222094,-0.225084,-0.228072,-0.231058,-0.234042,-0.237024,-0.240003,
		-0.242980,-0.245955,-0.248928,-0.251898,-0.254866,-0.257831,-0.260794,-0.263755,
		-0.266713,-0.269668,-0.272622,-0.275572,-0.278520,-0.281465,-0.284408,-0.287348,
		-0.290285,-0.293219,-0.296151,-0.299080,-0.302006,-0.304929,-0.307850,-0.310767,
		-0.313682,-0.316593,-0.319502,-0.322408,-0.325310,-0.328210,-0.331106,-0.334000,
		-0.336890,-0.339777,-0.342661,-0.345541,-0.348419,-0.351293,-0.354164,-0.357031,
		-0.359895,-0.362756,-0.365613,-0.368467,-0.371317,-0.374164,-0.377007,-0.379847,
		-0.382683,-0.385516,-0.388345,-0.391170,-0.393992,-0.396810,-0.399624,-0.402435,
		-0.405241,-0.408044,-0.410843,-0.413638,-0.416430,-0.419217,-0.422000,-0.424780,
		-0.427555,-0.430327,-0.433094,-0.435857,-0.438616,-0.441371,-0.444122,-0.446869,
		-0.449612,-0.452350,-0.455084,-0.457813,-0.460539,-0.463260,-0.465977,-0.468689,
		-0.471397,-0.474100,-0.476799,-0.479494,-0.482184,-0.484869,-0.487550,-0.490227,
		-0.492898,-0.495565,-0.498228,-0.500885,-0.503538,-0.506187,-0.508830,-0.511469,
		-0.514103,-0.516732,-0.519356,-0.521975,-0.524590,-0.527199,-0.529804,-0.532403,
		-0.534998,-0.537587,-0.540172,-0.542751,-0.545325,-0.547894,-0.550458,-0.553017,
		-0.555570,-0.558119,-0.560662,-0.563199,-0.565732,-0.568259,-0.570781,-0.573297,
		-0.575808,-0.578314,-0.580814,-0.583309,-0.585798,-0.588282,-0.590760,-0.593232,
		-0.595699,-0.598161,-0.600617,-0.603067,-0.605511,-0.607950,-0.610383,-0.612810,
		-0.615232,-0.617647,-0.620057,-0.622461,-0.624860,-0.627252,-0.629638,-0.632019,
		-0.634393,-0.636762,-0.639125,-0.641481,-0.643832,-0.646176,-0.648515,-0.650847,
		-0.653173,-0.655493,-0.657807,-0.660115,-0.662416,-0.664711,-0.667000,-0.669283,
		-0.671559,-0.673829,-0.676093,-0.678350,-0.680601,-0.682846,-0.685084,-0.687315,
		-0.689541,-0.691759,-0.693972,-0.696177,-0.698376,-0.700569,-0.702755,-0.704934,
		-0.707107,-0.709273,-0.711432,-0.713585,-0.715731,-0.717870,-0.720003,-0.722128,
		-0.724247,-0.726359,-0.728464,-0.730563,-0.732654,-0.734739,-0.736817,-0.738887,
		-0.740951,-0.743008,-0.745058,-0.747101,-0.749136,-0.751165,-0.753187,-0.755201,
		-0.757209,-0.759209,-0.761202,-0.763188,-0.765167,-0.767139,-0.769103,-0.771061,
		-0.773010,-0.774953,-0.776888,-0.778817,-0.780737,-0.782651,-0.784557,-0.786455,
		-0.788346,-0.790230,-0.792107,-0.793976,-0.795837,-0.797691,-0.799537,-0.801376,
		-0.803208,-0.805031,-0.806848,-0.808656,-0.810457,-0.812251,-0.814036,-0.815814,
		-0.817585,-0.819348,-0.821103,-0.822850,-0.824589,-0.826321,-0.828045,-0.829761,
		-0.831470,-0.833170,-0.834863,-0.836548,-0.838225,-0.839894,-0.841555,-0.843208,
		-0.844854,-0.846491,-0.848121,-0.849742,-0.851355,-0.852961,-0.854558,-0.856147,
		-0.857729,-0.859302,-0.860867,-0.862424,-0.863973,-0.865514,-0.867046,-0.868571,
		-0.870087,-0.871595,-0.873095,-0.874587,-0.876070,-0.877545,-0.879012,-0.880471,
		-0.881921,-0.883363,-0.884797,-0.886223,-0.887640,-0.889048,-0.890449,-0.891841,
		-0.893224,-0.894600,-0.895966,-0.897325,-0.898675,-0.900016,-0.901349,-0.902673,
		-0.903989,-0.905297,-0.906596,-0.907886,-0.909168,-0.910441,-0.911706,-0.912962,
		-0.914210,-0.915449,-0.916679,-0.917901,-0.919114,-0.920318,-0.921514,-0.922701,
		-0.923880,-0.925049,-0.926210,-0.927363,-0.928506,-0.929641,-0.930767,-0.931884,
		-0.932993,-0.934093,-0.935183,-0.936266,-0.937339,-0.938404,-0.939459,-0.940506,
		-0.941544,-0.942573,-0.943593,-0.944605,-0.945607,-0.946601,-0.947586,-0.948561,
		-0.949528,-0.950486,-0.951435,-0.952375,-0.953306,-0.954228,-0.955141,-0.956045,
		-0.956940,-0.957826,-0.958704,-0.959572,-0.960431,-0.961281,-0.962121,-0.962953,
		-0.963776,-0.964590,-0.965394,-0.966190,-0.966977,-0.967754,-0.968522,-0.969281,
		-0.970031,-0.970772,-0.971504,-0.972227,-0.972940,-0.973644,-0.974339,-0.975025,
		-0.975702,-0.976370,-0.977028,-0.977677,-0.978317,-0.978948,-0.979570,-0.980182,
		-0.980785,-0.981379,-0.981964,-0.982539,-0.983105,-0.983662,-0.984210,-0.984748,
		-0.985278,-0.985798,-0.986308,-0.986809,-0.987301,-0.987784,-0.988258,-0.988722,
		-0.989177,-0.989622,-0.990058,-0.990485,-0.990903,-0.991311,-0.991710,-0.992099,
		-0.992480,-0.992850,-0.993212,-0.993564,-0.993907,-0.994240,-0.994565,-0.994879,
		-0.995185,-0.995481,-0.995767,-0.996045,-0.996313,-0.996571,-0.996820,-0.997060,
		-0.997290,-0.997512,-0.997723,-0.997925,-0.998118,-0.998302,-0.998476,-0.998640,
		-0.998795,-0.998941,-0.999078,-0.999205,-0.999322,-0.999431,-0.999529,-0.999619,
		-0.999699,-0.999769,-0.999831,-0.999882,-0.999925,-0.999958,-0.999981,-0.999995,
		-1.000000,-0.999995,-0.999981,-0.999958,-0.999925,-0.999882,-0.999831,-0.999769,
		-0.999699,-0.999619,-0.999529,-0.999431,-0.999322,-0.999205,-0.999078,-0.998941,
		-0.998795,-0.998640,-0.998476,-0.998302,-0.998118,-0.997925,-0.997723,-0.997511,
		-0.997290,-0.997060,-0.996820,-0.996571,-0.996313,-0.996045,-0.995767,-0.995481,
		-0.995185,-0.994879,-0.994565,-0.994240,-0.993907,-0.993564,-0.993212,-0.992850,
		-0.992480,-0.992099,-0.991710,-0.991311,-0.990903,-0.990485,-0.990058,-0.989622,
		-0.989177,-0.988722,-0.988258,-0.987784,-0.987301,-0.986809,-0.986308,-0.985798,
		-0.985278,-0.984748,-0.984210,-0.983662,-0.983105,-0.982539,-0.981964,-0.981379,
		-0.980785,-0.980182,-0.979570,-0.978948,-0.978317,-0.977677,-0.977028,-0.976370,
		-0.975702,-0.975025,-0.974339,-0.973644,-0.972940,-0.972226,-0.971504,-0.970772,
		-0.970031,-0.969281,-0.968522,-0.967754,-0.966976,-0.966190,-0.965394,-0.964590,
		-0.963776,-0.962953,-0.962121,-0.961280,-0.960430,-0.959571,-0.958703,-0.957826,
		-0.956940,-0.956045,-0.955141,-0.954228,-0.953306,-0.952375,-0.951435,-0.950486,
		-0.949528,-0.948561,-0.947586,-0.946601,-0.945607,-0.944605,-0.943593,-0.942573,
		-0.941544,-0.940506,-0.939459,-0.938403,-0.937339,-0.936266,-0.935183,-0.934093,
		-0.932993,-0.931884,-0.930767,-0.929641,-0.928506,-0.927362,-0.926210,-0.925049,
		-0.923879,-0.922701,-0.921514,-0.920318,-0.919114,-0.917901,-0.916679,-0.915449,
		-0.914210,-0.912962,-0.911706,-0.910441,-0.909168,-0.907886,-0.906596,-0.905297,
		-0.903989,-0.902673,-0.901349,-0.900016,-0.898674,-0.897324,-0.895966,-0.894599,
		-0.893224,-0.891841,-0.890449,-0.889048,-0.887640,-0.886223,-0.884797,-0.883363,
		-0.881921,-0.880471,-0.879012,-0.877545,-0.876070,-0.874587,-0.873095,-0.871595,
		-0.870087,-0.868571,-0.867046,-0.865514,-0.863973,-0.862424,-0.860867,-0.859302,
		-0.857729,-0.856147,-0.854558,-0.852961,-0.851355,-0.849742,-0.848120,-0.846491,
		-0.844853,-0.843208,-0.841555,-0.839894,-0.838225,-0.836548,-0.834863,-0.833170,
		-0.831469,-0.829761,-0.828045,-0.826321,-0.824589,-0.822850,-0.821102,-0.819347,
		-0.817585,-0.815814,-0.814036,-0.812250,-0.810457,-0.808656,-0.806847,-0.805031,
		-0.803208,-0.801376,-0.799537,-0.797691,-0.795837,-0.793976,-0.792107,-0.790230,
		-0.788346,-0.786455,-0.784557,-0.782651,-0.780737,-0.778817,-0.776888,-0.774953,
		-0.773010,-0.771060,-0.769103,-0.767139,-0.765167,-0.763188,-0.761202,-0.759209,
		-0.757209,-0.755201,-0.753187,-0.751165,-0.749136,-0.747100,-0.745058,-0.743008,
		-0.740951,-0.738887,-0.736816,-0.734739,-0.732654,-0.730563,-0.728464,-0.726359,
		-0.724247,-0.722128,-0.720002,-0.717870,-0.715731,-0.713585,-0.711432,-0.709273,
		-0.707107,-0.704934,-0.702754,-0.700569,-0.698376,-0.696177,-0.693971,-0.691759,
		-0.689541,-0.687315,-0.685084,-0.682846,-0.680601,-0.678350,-0.676093,-0.673829,
		-0.671559,-0.669283,-0.667000,-0.664711,-0.662416,-0.660114,-0.657807,-0.655493,
		-0.653173,-0.650847,-0.648514,-0.646176,-0.643831,-0.641481,-0.639124,-0.636762,
		-0.634393,-0.632019,-0.629638,-0.627252,-0.624859,-0.622461,-0.620057,-0.617647,
		-0.615231,-0.612810,-0.610383,-0.607950,-0.605511,-0.603066,-0.600616,-0.598161,
		-0.595699,-0.593232,-0.590759,-0.588281,-0.585798,-0.583308,-0.580814,-0.578314,
		-0.575808,-0.573297,-0.570780,-0.568259,-0.565732,-0.563199,-0.560661,-0.558119,
		-0.555570,-0.553017,-0.550458,-0.547894,-0.545325,-0.542751,-0.540172,-0.537587,
		-0.534998,-0.532403,-0.529804,-0.527199,-0.524590,-0.521975,-0.519356,-0.516732,
		-0.514103,-0.511469,-0.508830,-0.506187,-0.503538,-0.500885,-0.498228,-0.495565,
		-0.492898,-0.490226,-0.487550,-0.484869,-0.482184,-0.479494,-0.476799,-0.474100,
		-0.471397,-0.468689,-0.465976,-0.463260,-0.460538,-0.457813,-0.455083,-0.452349,
		-0.449611,-0.446869,-0.444122,-0.441371,-0.438616,-0.435857,-0.433094,-0.430326,
		-0.427555,-0.424779,-0.422000,-0.419217,-0.416429,-0.413638,-0.410843,-0.408044,
		-0.405241,-0.402435,-0.399624,-0.396810,-0.393992,-0.391170,-0.388345,-0.385516,
		-0.382683,-0.379847,-0.377007,-0.374164,-0.371317,-0.368467,-0.365613,-0.362756,
		-0.359895,-0.357031,-0.354163,-0.351293,-0.348419,-0.345541,-0.342661,-0.339777,
		-0.336890,-0.333999,-0.331106,-0.328210,-0.325310,-0.322407,-0.319502,-0.316593,
		-0.313682,-0.310767,-0.307849,-0.304929,-0.302006,-0.299080,-0.296151,-0.293219,
		-0.290284,-0.287347,-0.284407,-0.281465,-0.278519,-0.275571,-0.272621,-0.269668,
		-0.266712,-0.263754,-0.260794,-0.257831,-0.254865,-0.251898,-0.248928,-0.245955,
		-0.242980,-0.240003,-0.237024,-0.234042,-0.231058,-0.228072,-0.225084,-0.222094,
		-0.219101,-0.216107,-0.213110,-0.210112,-0.207111,-0.204109,-0.201105,-0.198098,
		-0.195090,-0.192080,-0.189069,-0.186055,-0.183040,-0.180023,-0.177004,-0.173984,
		-0.170962,-0.167938,-0.164913,-0.161886,-0.158858,-0.155828,-0.152797,-0.149764,
		-0.146730,-0.143695,-0.140658,-0.137620,-0.134580,-0.131540,-0.128498,-0.125455,
		-0.122410,-0.119365,-0.116318,-0.113271,-0.110222,-0.107172,-0.104121,-0.101070,
		-0.098017,-0.094963,-0.091909,-0.088853,-0.085797,-0.082740,-0.079682,-0.076624,
		-0.073565,-0.070505,-0.067444,-0.064383,-0.061321,-0.058258,-0.055195,-0.052132,
		-0.049068,-0.046003,-0.042938,-0.039873,-0.036807,-0.033741,-0.030675,-0.027608,
		-0.024541,-0.021474,-0.018407,-0.015339,-0.012271,-0.009204,-0.006136,-0.003068,
		0.000000
	};

	const float Math::COS_TABLE[TRI_TABLE_SIZE + 1] = {
		1.000000,0.999995,0.999981,0.999958,0.999925,0.999882,0.999831,0.999769,
		0.999699,0.999619,0.999529,0.999431,0.999322,0.999205,0.999078,0.998941,
		0.998795,0.998640,0.998476,0.998302,0.998118,0.997925,0.997723,0.997511,
		0.997290,0.997060,0.996820,0.996571,0.996313,0.996045,0.995767,0.995481,
		0.995185,0.994879,0.994565,0.994240,0.993907,0.993564,0.993212,0.992850,
		0.992480,0.992099,0.991710,0.991311,0.990903,0.990485,0.990058,0.989622,
		0.989177,0.988722,0.988258,0.987784,0.987301,0.986809,0.986308,0.985798,
		0.985278,0.984748,0.984210,0.983662,0.983105,0.982539,0.981964,0.981379,
		0.980785,0.980182,0.979570,0.978948,0.978317,0.977677,0.977028,0.976370,
		0.975702,0.975025,0.974339,0.973644,0.972940,0.972227,0.971504,0.970772,
		0.970031,0.969281,0.968522,0.967754,0.966976,0.966190,0.965394,0.964590,
		0.963776,0.962953,0.962121,0.961280,0.960431,0.959572,0.958703,0.957826,
		0.956940,0.956045,0.955141,0.954228,0.953306,0.952375,0.951435,0.950486,
		0.949528,0.948561,0.947586,0.946601,0.945607,0.944605,0.943593,0.942573,
		0.941544,0.940506,0.939459,0.938404,0.937339,0.936266,0.935184,0.934093,
		0.932993,0.931884,0.930767,0.929641,0.928506,0.927363,0.926210,0.925049,
		0.923880,0.922701,0.921514,0.920318,0.919114,0.917901,0.916679,0.915449,
		0.914210,0.912962,0.911706,0.910441,0.909168,0.907886,0.906596,0.905297,
		0.903989,0.902673,0.901349,0.900016,0.898674,0.897325,0.895966,0.894599,
		0.893224,0.891841,0.890449,0.889048,0.887640,0.886223,0.884797,0.883363,
		0.881921,0.880471,0.879012,0.877545,0.876070,0.874587,0.873095,0.871595,
		0.870087,0.868571,0.867046,0.865514,0.863973,0.862424,0.860867,0.859302,
		0.857729,0.856147,0.854558,0.852961,0.851355,0.849742,0.848120,0.846491,
		0.844854,0.843208,0.841555,0.839894,0.838225,0.836548,0.834863,0.833170,
		0.831470,0.829761,0.828045,0.826321,0.824589,0.822850,0.821102,0.819348,
		0.817585,0.815814,0.814036,0.812251,0.810457,0.808656,0.806848,0.805031,
		0.803208,0.801376,0.799537,0.797691,0.795837,0.793975,0.792107,0.790230,
		0.788346,0.786455,0.784557,0.782651,0.780737,0.778817,0.776888,0.774953,
		0.773010,0.771061,0.769103,0.767139,0.765167,0.763188,0.761202,0.759209,
		0.757209,0.755201,0.753187,0.751165,0.749136,0.747101,0.745058,0.743008,
		0.740951,0.738887,0.736817,0.734739,0.732654,0.730563,0.728464,0.726359,
		0.724247,0.722128,0.720002,0.717870,0.715731,0.713585,0.711432,0.709273,
		0.707107,0.704934,0.702755,0.700569,0.698376,0.696177,0.693971,0.691759,
		0.689541,0.687315,0.685084,0.682846,0.680601,0.678350,0.676093,0.673829,
		0.671559,0.669283,0.667000,0.664711,0.662416,0.660114,0.657807,0.655493,
		0.653173,0.650847,0.648514,0.646176,0.643832,0.641481,0.639124,0.636762,
		0.634393,0.632019,0.629638,0.627252,0.624859,0.622461,0.620057,0.617647,
		0.615232,0.612810,0.610383,0.607950,0.605511,0.603067,0.600616,0.598161,
		0.595699,0.593232,0.590760,0.588282,0.585798,0.583309,0.580814,0.578314,
		0.575808,0.573297,0.570781,0.568259,0.565732,0.563199,0.560662,0.558119,
		0.555570,0.553017,0.550458,0.547894,0.545325,0.542751,0.540172,0.537587,
		0.534998,0.532403,0.529804,0.527199,0.524590,0.521975,0.519356,0.516732,
		0.514103,0.511469,0.508830,0.506187,0.503538,0.500885,0.498228,0.495565,
		0.492898,0.490226,0.487550,0.484869,0.482184,0.479494,0.476799,0.474100,
		0.471397,0.468689,0.465977,0.463260,0.460539,0.457813,0.455084,0.452350,
		0.449611,0.446869,0.444122,0.441371,0.438616,0.435857,0.433094,0.430326,
		0.427555,0.424780,0.422000,0.419217,0.416430,0.413638,0.410843,0.408044,
		0.405241,0.402435,0.399624,0.396810,0.393992,0.391170,0.388345,0.385516,
		0.382683,0.379847,0.377007,0.374164,0.371317,0.368467,0.365613,0.362756,
		0.359895,0.357031,0.354163,0.351293,0.348419,0.345541,0.342661,0.339777,
		0.336890,0.334000,0.331106,0.328210,0.325310,0.322408,0.319502,0.316593,
		0.313682,0.310767,0.307850,0.304929,0.302006,0.299080,0.296151,0.293219,
		0.290285,0.287347,0.284407,0.281465,0.278520,0.275572,0.272621,0.269668,
		0.266713,0.263755,0.260794,0.257831,0.254866,0.251898,0.248928,0.245955,
		0.242980,0.240003,0.237024,0.234042,0.231058,0.228072,0.225084,0.222094,
		0.219101,0.216107,0.213110,0.210112,0.207111,0.204109,0.201105,0.198098,
		0.195090,0.192080,0.189069,0.186055,0.183040,0.180023,0.177004,0.173984,
		0.170962,0.167938,0.164913,0.161886,0.158858,0.155828,0.152797,0.149764,
		0.146730,0.143695,0.140658,0.137620,0.134581,0.131540,0.128498,0.125455,
		0.122411,0.119365,0.116319,0.113271,0.110222,0.107172,0.104122,0.101070,
		0.098017,0.094963,0.091909,0.088854,0.085797,0.082740,0.079682,0.076624,
		0.073564,0.070504,0.067444,0.064383,0.061321,0.058258,0.055195,0.052132,
		0.049068,0.046003,0.042938,0.039873,0.036807,0.033741,0.030675,0.027608,
		0.024541,0.021474,0.018407,0.015339,0.012272,0.009204,0.006136,0.003068,
		-0.000000,-0.003068,-0.006136,-0.009204,-0.012272,-0.015339,-0.018407,-0.021474,
		-0.024541,-0.027608,-0.030675,-0.033741,-0.036807,-0.039873,-0.042938,-0.046003,
		-0.049068,-0.052132,-0.055195,-0.058258,-0.061321,-0.064383,-0.067444,-0.070505,
		-0.073565,-0.076624,-0.079682,-0.082740,-0.085797,-0.088854,-0.091909,-0.094964,
		-0.098017,-0.101070,-0.104122,-0.107172,-0.110222,-0.113271,-0.116319,-0.119365,
		-0.122411,-0.125455,-0.128498,-0.131540,-0.134581,-0.137620,-0.140658,-0.143695,
		-0.146731,-0.149765,-0.152797,-0.155828,-0.158858,-0.161886,-0.164913,-0.167938,
		-0.170962,-0.173984,-0.177004,-0.180023,-0.183040,-0.186055,-0.189069,-0.192080,
		-0.195090,-0.198098,-0.201105,-0.204109,-0.207111,-0.210112,-0.213110,-0.216107,
		-0.219101,-0.222094,-0.225084,-0.228072,-0.231058,-0.234042,-0.237024,-0.240003,
		-0.242980,-0.245955,-0.248928,-0.251898,-0.254866,-0.257831,-0.260794,-0.263755,
		-0.266713,-0.269668,-0.272621,-0.275572,-0.278520,-0.281465,-0.284408,-0.287347,
		-0.290285,-0.293219,-0.296151,-0.299080,-0.302006,-0.304929,-0.307850,-0.310767,
		-0.313682,-0.316593,-0.319502,-0.322408,-0.325310,-0.328210,-0.331106,-0.334000,
		-0.336890,-0.339777,-0.342661,-0.345541,-0.348419,-0.351293,-0.354164,-0.357031,
		-0.359895,-0.362756,-0.365613,-0.368467,-0.371317,-0.374164,-0.377007,-0.379847,
		-0.382684,-0.385516,-0.388345,-0.391170,-0.393992,-0.396810,-0.399624,-0.402435,
		-0.405241,-0.408044,-0.410843,-0.413638,-0.416430,-0.419217,-0.422000,-0.424780,
		-0.427555,-0.430326,-0.433094,-0.435857,-0.438616,-0.441371,-0.444122,-0.446869,
		-0.449611,-0.452350,-0.455084,-0.457813,-0.460539,-0.463260,-0.465977,-0.468689,
		-0.471397,-0.474100,-0.476799,-0.479494,-0.482184,-0.484869,-0.487550,-0.490226,
		-0.492898,-0.495565,-0.498228,-0.500885,-0.503538,-0.506187,-0.508830,-0.511469,
		-0.514103,-0.516732,-0.519356,-0.521975,-0.524590,-0.527199,-0.529804,-0.532403,
		-0.534998,-0.537587,-0.540172,-0.542751,-0.545325,-0.547894,-0.550458,-0.553017,
		-0.555570,-0.558119,-0.560662,-0.563199,-0.565732,-0.568259,-0.570781,-0.573297,
		-0.575808,-0.578314,-0.580814,-0.583309,-0.585798,-0.588282,-0.590760,-0.593232,
		-0.595699,-0.598161,-0.600617,-0.603067,-0.605511,-0.607950,-0.610383,-0.612810,
		-0.615232,-0.617647,-0.620057,-0.622461,-0.624860,-0.627252,-0.629638,-0.632019,
		-0.634393,-0.636762,-0.639124,-0.641481,-0.643832,-0.646176,-0.648514,-0.650847,
		-0.653173,-0.655493,-0.657807,-0.660114,-0.662416,-0.664711,-0.667000,-0.669283,
		-0.671559,-0.673829,-0.676093,-0.678350,-0.680601,-0.682846,-0.685084,-0.687315,
		-0.689541,-0.691759,-0.693971,-0.696177,-0.698376,-0.700569,-0.702755,-0.704934,
		-0.707107,-0.709273,-0.711432,-0.713585,-0.715731,-0.717870,-0.720003,-0.722128,
		-0.724247,-0.726359,-0.728464,-0.730563,-0.732654,-0.734739,-0.736817,-0.738887,
		-0.740951,-0.743008,-0.745058,-0.747101,-0.749137,-0.751165,-0.753187,-0.755201,
		-0.757209,-0.759209,-0.761202,-0.763188,-0.765167,-0.767139,-0.769103,-0.771061,
		-0.773010,-0.774953,-0.776888,-0.778817,-0.780737,-0.782651,-0.784557,-0.786455,
		-0.788346,-0.790230,-0.792107,-0.793976,-0.795837,-0.797691,-0.799537,-0.801376,
		-0.803208,-0.805031,-0.806848,-0.808656,-0.810457,-0.812251,-0.814036,-0.815814,
		-0.817585,-0.819348,-0.821103,-0.822850,-0.824589,-0.826321,-0.828045,-0.829761,
		-0.831470,-0.833170,-0.834863,-0.836548,-0.838225,-0.839894,-0.841555,-0.843208,
		-0.844854,-0.846491,-0.848120,-0.849742,-0.851355,-0.852961,-0.854558,-0.856147,
		-0.857729,-0.859302,-0.860867,-0.862424,-0.863973,-0.865514,-0.867046,-0.868571,
		-0.870087,-0.871595,-0.873095,-0.874587,-0.876070,-0.877545,-0.879012,-0.880471,
		-0.881921,-0.883363,-0.884797,-0.886223,-0.887640,-0.889048,-0.890449,-0.891841,
		-0.893224,-0.894599,-0.895966,-0.897325,-0.898674,-0.900016,-0.901349,-0.902673,
		-0.903989,-0.905297,-0.906596,-0.907886,-0.909168,-0.910441,-0.911706,-0.912962,
		-0.914210,-0.915449,-0.916679,-0.917901,-0.919114,-0.920318,-0.921514,-0.922701,
		-0.923880,-0.925049,-0.926210,-0.927363,-0.928506,-0.929641,-0.930767,-0.931884,
		-0.932993,-0.934093,-0.935184,-0.936266,-0.937339,-0.938404,-0.939459,-0.940506,
		-0.941544,-0.942573,-0.943594,-0.944605,-0.945607,-0.946601,-0.947586,-0.948561,
		-0.949528,-0.950486,-0.951435,-0.952375,-0.953306,-0.954228,-0.955141,-0.956045,
		-0.956940,-0.957826,-0.958703,-0.959572,-0.960431,-0.961280,-0.962121,-0.962953,
		-0.963776,-0.964590,-0.965394,-0.966190,-0.966976,-0.967754,-0.968522,-0.969281,
		-0.970031,-0.970772,-0.971504,-0.972227,-0.972940,-0.973644,-0.974339,-0.975025,
		-0.975702,-0.976370,-0.977028,-0.977677,-0.978317,-0.978948,-0.979570,-0.980182,
		-0.980785,-0.981379,-0.981964,-0.982539,-0.983105,-0.983662,-0.984210,-0.984749,
		-0.985278,-0.985798,-0.986308,-0.986809,-0.987301,-0.987784,-0.988258,-0.988722,
		-0.989177,-0.989622,-0.990058,-0.990485,-0.990903,-0.991311,-0.991710,-0.992099,
		-0.992480,-0.992850,-0.993212,-0.993564,-0.993907,-0.994240,-0.994565,-0.994879,
		-0.995185,-0.995481,-0.995767,-0.996045,-0.996313,-0.996571,-0.996820,-0.997060,
		-0.997290,-0.997511,-0.997723,-0.997925,-0.998118,-0.998302,-0.998476,-0.998640,
		-0.998795,-0.998941,-0.999078,-0.999205,-0.999322,-0.999431,-0.999529,-0.999619,
		-0.999699,-0.999769,-0.999831,-0.999882,-0.999925,-0.999958,-0.999981,-0.999995,
		-1.000000,-0.999995,-0.999981,-0.999958,-0.999925,-0.999882,-0.999831,-0.999769,
		-0.999699,-0.999619,-0.999529,-0.999431,-0.999322,-0.999205,-0.999078,-0.998941,
		-0.998795,-0.998640,-0.998476,-0.998302,-0.998118,-0.997925,-0.997723,-0.997511,
		-0.997290,-0.997060,-0.996820,-0.996571,-0.996313,-0.996045,-0.995767,-0.995481,
		-0.995185,-0.994879,-0.994565,-0.994240,-0.993907,-0.993564,-0.993212,-0.992850,
		-0.992480,-0.992099,-0.991710,-0.991311,-0.990903,-0.990485,-0.990058,-0.989622,
		-0.989177,-0.988722,-0.988258,-0.987784,-0.987301,-0.986809,-0.986308,-0.985797,
		-0.985278,-0.984748,-0.984210,-0.983662,-0.983105,-0.982539,-0.981964,-0.981379,
		-0.980785,-0.980182,-0.979570,-0.978948,-0.978317,-0.977677,-0.977028,-0.976370,
		-0.975702,-0.975025,-0.974339,-0.973644,-0.972940,-0.972227,-0.971504,-0.970772,
		-0.970031,-0.969281,-0.968522,-0.967754,-0.966976,-0.966190,-0.965394,-0.964590,
		-0.963776,-0.962953,-0.962121,-0.961280,-0.960430,-0.959571,-0.958703,-0.957826,
		-0.956940,-0.956045,-0.955141,-0.954228,-0.953306,-0.952375,-0.951435,-0.950486,
		-0.949528,-0.948561,-0.947586,-0.946601,-0.945607,-0.944605,-0.943593,-0.942573,
		-0.941544,-0.940506,-0.939459,-0.938403,-0.937339,-0.936266,-0.935183,-0.934092,
		-0.932993,-0.931884,-0.930767,-0.929641,-0.928506,-0.927363,-0.926210,-0.925049,
		-0.923880,-0.922701,-0.921514,-0.920318,-0.919114,-0.917901,-0.916679,-0.915449,
		-0.914210,-0.912962,-0.911706,-0.910441,-0.909168,-0.907886,-0.906596,-0.905297,
		-0.903989,-0.902673,-0.901349,-0.900016,-0.898674,-0.897325,-0.895966,-0.894599,
		-0.893224,-0.891841,-0.890449,-0.889048,-0.887640,-0.886223,-0.884797,-0.883363,
		-0.881921,-0.880471,-0.879012,-0.877545,-0.876070,-0.874587,-0.873095,-0.871595,
		-0.870087,-0.868571,-0.867046,-0.865514,-0.863973,-0.862424,-0.860867,-0.859302,
		-0.857729,-0.856147,-0.854558,-0.852960,-0.851355,-0.849742,-0.848120,-0.846491,
		-0.844854,-0.843208,-0.841555,-0.839894,-0.838225,-0.836548,-0.834863,-0.833170,
		-0.831470,-0.829761,-0.828045,-0.826321,-0.824589,-0.822850,-0.821102,-0.819347,
		-0.817585,-0.815814,-0.814036,-0.812250,-0.810457,-0.808656,-0.806847,-0.805031,
		-0.803208,-0.801376,-0.799537,-0.797691,-0.795837,-0.793975,-0.792107,-0.790230,
		-0.788346,-0.786455,-0.784557,-0.782651,-0.780737,-0.778816,-0.776888,-0.774953,
		-0.773010,-0.771060,-0.769103,-0.767139,-0.765167,-0.763188,-0.761202,-0.759209,
		-0.757209,-0.755201,-0.753187,-0.751165,-0.749136,-0.747101,-0.745058,-0.743008,
		-0.740951,-0.738887,-0.736817,-0.734739,-0.732654,-0.730563,-0.728464,-0.726359,
		-0.724247,-0.722128,-0.720002,-0.717870,-0.715731,-0.713585,-0.711432,-0.709273,
		-0.707107,-0.704934,-0.702755,-0.700569,-0.698376,-0.696177,-0.693971,-0.691759,
		-0.689541,-0.687315,-0.685084,-0.682846,-0.680601,-0.678350,-0.676093,-0.673829,
		-0.671559,-0.669283,-0.667000,-0.664711,-0.662416,-0.660114,-0.657807,-0.655493,
		-0.653173,-0.650847,-0.648514,-0.646176,-0.643832,-0.641481,-0.639124,-0.636762,
		-0.634393,-0.632019,-0.629638,-0.627252,-0.624860,-0.622461,-0.620057,-0.617647,
		-0.615232,-0.612810,-0.610383,-0.607950,-0.605511,-0.603067,-0.600616,-0.598161,
		-0.595699,-0.593232,-0.590760,-0.588281,-0.585798,-0.583309,-0.580814,-0.578314,
		-0.575808,-0.573297,-0.570781,-0.568259,-0.565732,-0.563199,-0.560661,-0.558118,
		-0.555570,-0.553016,-0.550458,-0.547894,-0.545325,-0.542751,-0.540171,-0.537587,
		-0.534997,-0.532403,-0.529803,-0.527199,-0.524589,-0.521975,-0.519356,-0.516732,
		-0.514103,-0.511469,-0.508830,-0.506187,-0.503538,-0.500885,-0.498228,-0.495565,
		-0.492898,-0.490227,-0.487550,-0.484869,-0.482184,-0.479494,-0.476799,-0.474100,
		-0.471397,-0.468689,-0.465976,-0.463260,-0.460539,-0.457813,-0.455083,-0.452349,
		-0.449611,-0.446869,-0.444122,-0.441371,-0.438616,-0.435857,-0.433094,-0.430326,
		-0.427555,-0.424780,-0.422000,-0.419217,-0.416429,-0.413638,-0.410843,-0.408044,
		-0.405241,-0.402434,-0.399624,-0.396810,-0.393992,-0.391170,-0.388345,-0.385516,
		-0.382683,-0.379847,-0.377007,-0.374164,-0.371317,-0.368467,-0.365613,-0.362756,
		-0.359895,-0.357031,-0.354164,-0.351293,-0.348419,-0.345541,-0.342661,-0.339777,
		-0.336890,-0.334000,-0.331106,-0.328210,-0.325310,-0.322408,-0.319502,-0.316593,
		-0.313682,-0.310767,-0.307850,-0.304929,-0.302006,-0.299080,-0.296151,-0.293219,
		-0.290285,-0.287347,-0.284407,-0.281465,-0.278520,-0.275572,-0.272621,-0.269668,
		-0.266713,-0.263754,-0.260794,-0.257831,-0.254865,-0.251898,-0.248927,-0.245955,
		-0.242980,-0.240003,-0.237023,-0.234042,-0.231058,-0.228072,-0.225084,-0.222093,
		-0.219101,-0.216106,-0.213110,-0.210112,-0.207111,-0.204109,-0.201105,-0.198098,
		-0.195090,-0.192080,-0.189069,-0.186055,-0.183040,-0.180023,-0.177004,-0.173984,
		-0.170962,-0.167938,-0.164913,-0.161886,-0.158858,-0.155828,-0.152797,-0.149764,
		-0.146730,-0.143695,-0.140658,-0.137620,-0.134581,-0.131540,-0.128498,-0.125455,
		-0.122411,-0.119365,-0.116318,-0.113271,-0.110222,-0.107172,-0.104121,-0.101070,
		-0.098017,-0.094963,-0.091909,-0.088853,-0.085797,-0.082740,-0.079682,-0.076624,
		-0.073564,-0.070504,-0.067444,-0.064382,-0.061320,-0.058258,-0.055195,-0.052131,
		-0.049067,-0.046003,-0.042938,-0.039873,-0.036807,-0.033741,-0.030675,-0.027608,
		-0.024541,-0.021474,-0.018407,-0.015339,-0.012272,-0.009204,-0.006136,-0.003068,
		0.000000,0.003068,0.006136,0.009204,0.012272,0.015339,0.018407,0.021474,
		0.024541,0.027608,0.030675,0.033741,0.036807,0.039873,0.042938,0.046003,
		0.049068,0.052132,0.055195,0.058258,0.061321,0.064383,0.067444,0.070505,
		0.073565,0.076624,0.079683,0.082741,0.085798,0.088854,0.091909,0.094964,
		0.098017,0.101070,0.104122,0.107173,0.110223,0.113271,0.116319,0.119366,
		0.122411,0.125455,0.128498,0.131540,0.134581,0.137620,0.140658,0.143695,
		0.146730,0.149764,0.152797,0.155828,0.158858,0.161886,0.164913,0.167938,
		0.170962,0.173984,0.177004,0.180023,0.183040,0.186055,0.189069,0.192080,
		0.195090,0.198099,0.201105,0.204109,0.207111,0.210112,0.213110,0.216107,
		0.219101,0.222094,0.225084,0.228072,0.231058,0.234042,0.237024,0.240003,
		0.242980,0.245955,0.248928,0.251898,0.254866,0.257831,0.260794,0.263755,
		0.266713,0.269669,0.272622,0.275572,0.278520,0.281465,0.284408,0.287348,
		0.290285,0.293219,0.296151,0.299080,0.302006,0.304929,0.307850,0.310767,
		0.313682,0.316593,0.319502,0.322408,0.325310,0.328210,0.331106,0.334000,
		0.336890,0.339777,0.342661,0.345541,0.348419,0.351293,0.354164,0.357031,
		0.359895,0.362756,0.365613,0.368467,0.371317,0.374164,0.377008,0.379847,
		0.382684,0.385516,0.388345,0.391171,0.393992,0.396810,0.399624,0.402435,
		0.405242,0.408044,0.410843,0.413639,0.416430,0.419217,0.422001,0.424780,
		0.427555,0.430327,0.433094,0.435857,0.438617,0.441372,0.444122,0.446869,
		0.449612,0.452350,0.455084,0.457813,0.460539,0.463260,0.465976,0.468689,
		0.471397,0.474100,0.476799,0.479494,0.482184,0.484869,0.487550,0.490227,
		0.492898,0.495565,0.498228,0.500885,0.503538,0.506187,0.508830,0.511469,
		0.514103,0.516732,0.519356,0.521975,0.524590,0.527199,0.529804,0.532403,
		0.534998,0.537587,0.540172,0.542751,0.545325,0.547894,0.550458,0.553017,
		0.555570,0.558119,0.560662,0.563200,0.565732,0.568259,0.570781,0.573297,
		0.575808,0.578314,0.580814,0.583309,0.585798,0.588282,0.590760,0.593233,
		0.595699,0.598161,0.600616,0.603067,0.605511,0.607950,0.610383,0.612810,
		0.615232,0.617647,0.620057,0.622461,0.624860,0.627252,0.629638,0.632019,
		0.634393,0.636762,0.639125,0.641481,0.643832,0.646176,0.648515,0.650847,
		0.653173,0.655493,0.657807,0.660114,0.662416,0.664711,0.667000,0.669283,
		0.671559,0.673829,0.676093,0.678350,0.680601,0.682846,0.685084,0.687316,
		0.689541,0.691759,0.693972,0.696177,0.698376,0.700569,0.702755,0.704934,
		0.707107,0.709273,0.711432,0.713585,0.715731,0.717870,0.720003,0.722128,
		0.724247,0.726359,0.728464,0.730563,0.732654,0.734739,0.736817,0.738887,
		0.740951,0.743008,0.745058,0.747101,0.749136,0.751165,0.753187,0.755201,
		0.757209,0.759209,0.761202,0.763188,0.765167,0.767139,0.769103,0.771061,
		0.773011,0.774953,0.776889,0.778817,0.780737,0.782651,0.784557,0.786455,
		0.788347,0.790230,0.792107,0.793976,0.795837,0.797691,0.799537,0.801376,
		0.803208,0.805031,0.806848,0.808656,0.810457,0.812251,0.814037,0.815815,
		0.817585,0.819348,0.821103,0.822850,0.824589,0.826321,0.828045,0.829761,
		0.831470,0.833170,0.834863,0.836548,0.838225,0.839894,0.841555,0.843208,
		0.844854,0.846491,0.848120,0.849742,0.851355,0.852961,0.854558,0.856147,
		0.857729,0.859302,0.860867,0.862424,0.863973,0.865514,0.867046,0.868571,
		0.870087,0.871595,0.873095,0.874587,0.876070,0.877545,0.879012,0.880471,
		0.881921,0.883363,0.884797,0.886223,0.887640,0.889048,0.890449,0.891841,
		0.893224,0.894600,0.895966,0.897325,0.898675,0.900016,0.901349,0.902673,
		0.903989,0.905297,0.906596,0.907886,0.909168,0.910441,0.911706,0.912962,
		0.914210,0.915449,0.916679,0.917901,0.919114,0.920318,0.921514,0.922701,
		0.923880,0.925049,0.926210,0.927363,0.928506,0.929641,0.930767,0.931884,
		0.932993,0.934093,0.935184,0.936266,0.937339,0.938404,0.939459,0.940506,
		0.941544,0.942573,0.943594,0.944605,0.945607,0.946601,0.947586,0.948561,
		0.949528,0.950486,0.951435,0.952375,0.953306,0.954228,0.955141,0.956045,
		0.956940,0.957826,0.958704,0.959572,0.960431,0.961281,0.962121,0.962953,
		0.963776,0.964590,0.965395,0.966190,0.966977,0.967754,0.968522,0.969281,
		0.970031,0.970772,0.971504,0.972227,0.972940,0.973644,0.974339,0.975025,
		0.975702,0.976370,0.977028,0.977677,0.978317,0.978948,0.979570,0.980182,
		0.980785,0.981379,0.981964,0.982539,0.983106,0.983662,0.984210,0.984749,
		0.985278,0.985798,0.986308,0.986809,0.987301,0.987784,0.988258,0.988722,
		0.989177,0.989622,0.990058,0.990485,0.990903,0.991311,0.991710,0.992099,
		0.992480,0.992850,0.993212,0.993564,0.993907,0.994240,0.994565,0.994879,
		0.995185,0.995481,0.995767,0.996045,0.996313,0.996571,0.996820,0.997060,
		0.997290,0.997511,0.997723,0.997925,0.998118,0.998302,0.998476,0.998640,
		0.998795,0.998941,0.999078,0.999205,0.999322,0.999431,0.999529,0.999619,
		0.999699,0.999769,0.999831,0.999882,0.999925,0.999958,0.999981,0.999995,
		1.000000,
	};

	const float Math::ACOS_TABLE[TRI_TABLE_SIZE + 1] = {
		3.141593,3.097395,3.079082,3.065027,3.053175,3.042731,3.033287,3.024599,
		3.016511,3.008913,3.001724,2.994886,2.988350,2.982079,2.976044,2.970220,
		2.964585,2.959122,2.953817,2.948656,2.943627,2.938722,2.933931,2.929246,
		2.924661,2.920170,2.915766,2.911445,2.907203,2.903034,2.898936,2.894905,
		2.890937,2.887030,2.883180,2.879386,2.875644,2.871954,2.868312,2.864717,
		2.861166,2.857659,2.854194,2.850768,2.847382,2.844033,2.840720,2.837442,
		2.834198,2.830986,2.827807,2.824658,2.821540,2.818450,2.815389,2.812355,
		2.809348,2.806366,2.803411,2.800479,2.797572,2.794688,2.791827,2.788989,
		2.786171,2.783376,2.780601,2.777846,2.775111,2.772395,2.769698,2.767020,
		2.764360,2.761718,2.759093,2.756485,2.753893,2.751318,2.748759,2.746216,
		2.743688,2.741175,2.738678,2.736194,2.733725,2.731270,2.728829,2.726401,
		2.723987,2.721585,2.719197,2.716821,2.714458,2.712106,2.709767,2.707439,
		2.705124,2.702819,2.700526,2.698244,2.695973,2.693713,2.691463,2.689224,
		2.686994,2.684775,2.682566,2.680367,2.678178,2.675998,2.673827,2.671666,
		2.669514,2.667371,2.665237,2.663112,2.660995,2.658887,2.656787,2.654696,
		2.652613,2.650538,2.648471,2.646412,2.644361,2.642317,2.640281,2.638253,
		2.636232,2.634219,2.632212,2.630213,2.628221,2.626236,2.624258,2.622287,
		2.620323,2.618365,2.616414,2.614470,2.612531,2.610600,2.608674,2.606755,
		2.604842,2.602936,2.601035,2.599140,2.597252,2.595369,2.593492,2.591620,
		2.589755,2.587895,2.586040,2.584192,2.582348,2.580510,2.578678,2.576850,
		2.575028,2.573211,2.571400,2.569593,2.567792,2.565995,2.564204,2.562417,
		2.560635,2.558858,2.557086,2.555319,2.553556,2.551798,2.550044,2.548295,
		2.546551,2.544811,2.543075,2.541344,2.539618,2.537895,2.536177,2.534463,
		2.532753,2.531048,2.529347,2.527650,2.525956,2.524267,2.522582,2.520901,
		2.519224,2.517551,2.515882,2.514216,2.512554,2.510896,2.509242,2.507592,
		2.505945,2.504302,2.502663,2.501027,2.499395,2.497766,2.496141,2.494519,
		2.492901,2.491287,2.489675,2.488067,2.486463,2.484861,2.483264,2.481669,
		2.480078,2.478490,2.476905,2.475323,2.473745,2.472169,2.470597,2.469028,
		2.467462,2.465899,2.464339,2.462782,2.461229,2.459678,2.458130,2.456585,
		2.455043,2.453504,2.451967,2.450434,2.448903,2.447375,2.445850,2.444328,
		2.442809,2.441292,2.439778,2.438267,2.436758,2.435252,2.433749,2.432248,
		2.430750,2.429255,2.427762,2.426272,2.424784,2.423299,2.421816,2.420336,
		2.418858,2.417383,2.415910,2.414440,2.412972,2.411507,2.410044,2.408583,
		2.407125,2.405669,2.404215,2.402764,2.401315,2.399868,2.398424,2.396982,
		2.395542,2.394104,2.392669,2.391235,2.389804,2.388376,2.386949,2.385525,
		2.384102,2.382682,2.381264,2.379848,2.378434,2.377022,2.375612,2.374205,
		2.372799,2.371396,2.369994,2.368594,2.367197,2.365801,2.364408,2.363016,
		2.361627,2.360239,2.358853,2.357470,2.356088,2.354708,2.353330,2.351954,
		2.350579,2.349207,2.347836,2.346467,2.345100,2.343735,2.342372,2.341011,
		2.339651,2.338293,2.336937,2.335582,2.334230,2.332879,2.331530,2.330183,
		2.328837,2.327493,2.326151,2.324811,2.323472,2.322134,2.320799,2.319465,
		2.318133,2.316802,2.315473,2.314146,2.312820,2.311496,2.310174,2.308853,
		2.307534,2.306216,2.304900,2.303585,2.302272,2.300961,2.299651,2.298342,
		2.297035,2.295730,2.294426,2.293124,2.291823,2.290524,2.289226,2.287929,
		2.286634,2.285341,2.284049,2.282758,2.281469,2.280181,2.278895,2.277610,
		2.276326,2.275044,2.273764,2.272484,2.271206,2.269930,2.268655,2.267381,
		2.266108,2.264837,2.263567,2.262299,2.261032,2.259766,2.258502,2.257238,
		2.255976,2.254716,2.253457,2.252199,2.250942,2.249686,2.248432,2.247180,
		2.245928,2.244678,2.243428,2.242181,2.240934,2.239688,2.238444,2.237201,
		2.235960,2.234719,2.233479,2.232241,2.231004,2.229769,2.228534,2.227301,
		2.226068,2.224837,2.223607,2.222379,2.221151,2.219925,2.218699,2.217475,
		2.216252,2.215030,2.213809,2.212590,2.211371,2.210154,2.208937,2.207722,
		2.206508,2.205295,2.204082,2.202872,2.201662,2.200453,2.199245,2.198038,
		2.196833,2.195628,2.194425,2.193222,2.192021,2.190820,2.189621,2.188422,
		2.187225,2.186029,2.184834,2.183639,2.182446,2.181254,2.180062,2.178872,
		2.177683,2.176494,2.175307,2.174120,2.172935,2.171751,2.170567,2.169384,
		2.168203,2.167022,2.165842,2.164664,2.163486,2.162309,2.161133,2.159958,
		2.158784,2.157610,2.156438,2.155267,2.154096,2.152927,2.151758,2.150590,
		2.149423,2.148257,2.147092,2.145928,2.144765,2.143602,2.142441,2.141280,
		2.140120,2.138961,2.137803,2.136646,2.135489,2.134333,2.133179,2.132025,
		2.130872,2.129719,2.128568,2.127417,2.126268,2.125118,2.123971,2.122823,
		2.121677,2.120531,2.119386,2.118242,2.117099,2.115956,2.114814,2.113673,
		2.112533,2.111394,2.110255,2.109118,2.107980,2.106844,2.105709,2.104574,
		2.103440,2.102307,2.101174,2.100043,2.098912,2.097781,2.096652,2.095523,
		2.094395,2.093268,2.092141,2.091016,2.089890,2.088766,2.087642,2.086519,
		2.085397,2.084276,2.083155,2.082035,2.080915,2.079797,2.078679,2.077562,
		2.076445,2.075329,2.074214,2.073099,2.071985,2.070872,2.069760,2.068648,
		2.067537,2.066426,2.065316,2.064207,2.063099,2.061991,2.060884,2.059777,
		2.058671,2.057566,2.056462,2.055358,2.054255,2.053152,2.052050,2.050948,
		2.049848,2.048748,2.047648,2.046549,2.045451,2.044353,2.043256,2.042160,
		2.041064,2.039969,2.038874,2.037780,2.036687,2.035594,2.034502,2.033411,
		2.032320,2.031229,2.030139,2.029050,2.027961,2.026874,2.025786,2.024699,
		2.023613,2.022527,2.021442,2.020357,2.019274,2.018190,2.017107,2.016025,
		2.014943,2.013862,2.012781,2.011701,2.010622,2.009542,2.008464,2.007386,
		2.006309,2.005232,2.004156,2.003080,2.002005,2.000930,1.999856,1.998782,
		1.997709,1.996636,1.995564,1.994493,1.993422,1.992351,1.991281,1.990212,
		1.989143,1.988074,1.987006,1.985939,1.984872,1.983805,1.982739,1.981674,
		1.980609,1.979545,1.978480,1.977417,1.976354,1.975291,1.974229,1.973168,
		1.972107,1.971046,1.969986,1.968926,1.967867,1.966808,1.965750,1.964692,
		1.963635,1.962578,1.961522,1.960466,1.959410,1.958355,1.957301,1.956247,
		1.955193,1.954140,1.953087,1.952035,1.950983,1.949932,1.948881,1.947830,
		1.946780,1.945730,1.944681,1.943632,1.942584,1.941536,1.940488,1.939441,
		1.938394,1.937348,1.936302,1.935257,1.934212,1.933167,1.932123,1.931079,
		1.930036,1.928993,1.927951,1.926908,1.925867,1.924825,1.923784,1.922744,
		1.921704,1.920664,1.919625,1.918586,1.917547,1.916509,1.915471,1.914434,
		1.913397,1.912360,1.911324,1.910288,1.909253,1.908217,1.907183,1.906148,
		1.905114,1.904081,1.903047,1.902015,1.900982,1.899950,1.898918,1.897887,
		1.896856,1.895825,1.894795,1.893765,1.892735,1.891706,1.890677,1.889648,
		1.888620,1.887592,1.886565,1.885537,1.884511,1.883484,1.882458,1.881432,
		1.880407,1.879382,1.878357,1.877332,1.876308,1.875284,1.874261,1.873238,
		1.872215,1.871192,1.870170,1.869148,1.868127,1.867105,1.866085,1.865064,
		1.864044,1.863024,1.862004,1.860985,1.859966,1.858947,1.857929,1.856911,
		1.855893,1.854875,1.853858,1.852841,1.851825,1.850808,1.849792,1.848777,
		1.847761,1.846746,1.845731,1.844717,1.843703,1.842689,1.841675,1.840662,
		1.839648,1.838636,1.837623,1.836611,1.835599,1.834587,1.833576,1.832565,
		1.831554,1.830543,1.829533,1.828523,1.827513,1.826504,1.825494,1.824485,
		1.823477,1.822468,1.821460,1.820452,1.819444,1.818437,1.817430,1.816423,
		1.815416,1.814410,1.813404,1.812398,1.811392,1.810387,1.809381,1.808377,
		1.807372,1.806368,1.805363,1.804359,1.803356,1.802352,1.801349,1.800346,
		1.799343,1.798341,1.797338,1.796336,1.795335,1.794333,1.793332,1.792331,
		1.791330,1.790329,1.789328,1.788328,1.787328,1.786328,1.785329,1.784329,
		1.783330,1.782331,1.781333,1.780334,1.779336,1.778338,1.777340,1.776342,
		1.775345,1.774347,1.773350,1.772354,1.771357,1.770360,1.769364,1.768368,
		1.767372,1.766377,1.765381,1.764386,1.763391,1.762396,1.761402,1.760407,
		1.759413,1.758419,1.757425,1.756431,1.755437,1.754444,1.753451,1.752458,
		1.751465,1.750472,1.749480,1.748488,1.747496,1.746504,1.745512,1.744520,
		1.743529,1.742538,1.741547,1.740556,1.739565,1.738575,1.737584,1.736594,
		1.735604,1.734614,1.733624,1.732635,1.731645,1.730656,1.729667,1.728678,
		1.727689,1.726701,1.725712,1.724724,1.723736,1.722748,1.721760,1.720772,
		1.719784,1.718797,1.717810,1.716823,1.715836,1.714849,1.713862,1.712875,
		1.711889,1.710903,1.709917,1.708930,1.707945,1.706959,1.705973,1.704988,
		1.704002,1.703017,1.702032,1.701047,1.700062,1.699078,1.698093,1.697109,
		1.696124,1.695140,1.694156,1.693172,1.692188,1.691204,1.690221,1.689237,
		1.688254,1.687270,1.686287,1.685304,1.684321,1.683338,1.682356,1.681373,
		1.680391,1.679408,1.678426,1.677444,1.676462,1.675480,1.674498,1.673516,
		1.672534,1.671553,1.670571,1.669590,1.668608,1.667627,1.666646,1.665665,
		1.664684,1.663703,1.662723,1.661742,1.660761,1.659781,1.658800,1.657820,
		1.656840,1.655860,1.654880,1.653900,1.652920,1.651940,1.650960,1.649981,
		1.649001,1.648021,1.647042,1.646063,1.645083,1.644104,1.643125,1.642146,
		1.641167,1.640188,1.639209,1.638230,1.637251,1.636273,1.635294,1.634316,
		1.633337,1.632359,1.631380,1.630402,1.629424,1.628445,1.627467,1.626489,
		1.625511,1.624533,1.623555,1.622577,1.621599,1.620622,1.619644,1.618666,
		1.617689,1.616711,1.615733,1.614756,1.613778,1.612801,1.611823,1.610846,
		1.609869,1.608891,1.607914,1.606937,1.605960,1.604983,1.604006,1.603028,
		1.602051,1.601074,1.600097,1.599120,1.598143,1.597167,1.596190,1.595213,
		1.594236,1.593259,1.592282,1.591306,1.590329,1.589352,1.588375,1.587399,
		1.586422,1.585445,1.584469,1.583492,1.582515,1.581539,1.580562,1.579586,
		1.578609,1.577632,1.576656,1.575679,1.574703,1.573726,1.572749,1.571773,
		1.570796,1.569820,1.568843,1.567867,1.566890,1.565913,1.564937,1.563960,
		1.562984,1.562007,1.561031,1.560054,1.559077,1.558101,1.557124,1.556147,
		1.555171,1.554194,1.553217,1.552241,1.551264,1.550287,1.549310,1.548334,
		1.547357,1.546380,1.545403,1.544426,1.543449,1.542472,1.541495,1.540518,
		1.539541,1.538564,1.537587,1.536610,1.535633,1.534656,1.533678,1.532701,
		1.531724,1.530747,1.529769,1.528792,1.527814,1.526837,1.525859,1.524882,
		1.523904,1.522926,1.521949,1.520971,1.519993,1.519015,1.518037,1.517060,
		1.516082,1.515103,1.514125,1.513147,1.512169,1.511191,1.510212,1.509234,
		1.508256,1.507277,1.506299,1.505320,1.504341,1.503362,1.502384,1.501405,
		1.500426,1.499447,1.498468,1.497488,1.496509,1.495530,1.494551,1.493571,
		1.492592,1.491612,1.490632,1.489653,1.488673,1.487693,1.486713,1.485733,
		1.484753,1.483773,1.482792,1.481812,1.480831,1.479851,1.478870,1.477889,
		1.476908,1.475927,1.474946,1.473965,1.472984,1.472003,1.471022,1.470040,
		1.469058,1.468077,1.467095,1.466113,1.465131,1.464149,1.463167,1.462184,
		1.461202,1.460220,1.459237,1.458254,1.457271,1.456288,1.455305,1.454322,
		1.453339,1.452356,1.451372,1.450388,1.449405,1.448421,1.447437,1.446453,
		1.445469,1.444484,1.443500,1.442515,1.441530,1.440546,1.439561,1.438576,
		1.437590,1.436605,1.435619,1.434634,1.433648,1.432662,1.431676,1.430690,
		1.429704,1.428717,1.427731,1.426744,1.425757,1.424770,1.423783,1.422796,
		1.421808,1.420821,1.419833,1.418845,1.417857,1.416869,1.415881,1.414892,
		1.413903,1.412915,1.411926,1.410937,1.409947,1.408958,1.407968,1.406979,
		1.405989,1.404999,1.404009,1.403018,1.402027,1.401037,1.400046,1.399055,
		1.398064,1.397072,1.396081,1.395089,1.394097,1.393105,1.392113,1.391120,
		1.390128,1.389135,1.388142,1.387149,1.386155,1.385162,1.384168,1.383174,
		1.382180,1.381186,1.380191,1.379197,1.378202,1.377207,1.376211,1.375216,
		1.374220,1.373224,1.372228,1.371232,1.370236,1.369239,1.368242,1.367245,
		1.366248,1.365250,1.364253,1.363255,1.362257,1.361259,1.360260,1.359261,
		1.358262,1.357263,1.356264,1.355264,1.354264,1.353264,1.352264,1.351264,
		1.350263,1.349262,1.348261,1.347260,1.346258,1.345256,1.344254,1.343252,
		1.342249,1.341247,1.340244,1.339240,1.338237,1.337233,1.336229,1.335225,
		1.334221,1.333216,1.332211,1.331206,1.330201,1.329195,1.328189,1.327183,
		1.326177,1.325170,1.324163,1.323156,1.322148,1.321141,1.320133,1.319125,
		1.318116,1.317107,1.316098,1.315089,1.314080,1.313070,1.312060,1.311049,
		1.310039,1.309028,1.308017,1.307005,1.305994,1.304982,1.303970,1.302957,
		1.301944,1.300931,1.299918,1.298904,1.297890,1.296876,1.295861,1.294847,
		1.293831,1.292816,1.291800,1.290784,1.289768,1.288751,1.287735,1.286717,
		1.285700,1.284682,1.283664,1.282646,1.281627,1.280608,1.279589,1.278569,
		1.277549,1.276529,1.275508,1.274487,1.273466,1.272444,1.271423,1.270400,
		1.269378,1.268355,1.267332,1.266308,1.265285,1.264260,1.263236,1.262211,
		1.261186,1.260161,1.259135,1.258108,1.257082,1.256055,1.255028,1.254001,
		1.252973,1.251944,1.250916,1.249887,1.248858,1.247828,1.246798,1.245768,
		1.244737,1.243706,1.242674,1.241643,1.240611,1.239578,1.238545,1.237512,
		1.236478,1.235444,1.234410,1.233375,1.232340,1.231305,1.230269,1.229233,
		1.228196,1.227159,1.226122,1.225084,1.224046,1.223007,1.221968,1.220929,
		1.219889,1.218849,1.217808,1.216767,1.215726,1.214684,1.213642,1.212600,
		1.211557,1.210513,1.209470,1.208425,1.207381,1.206336,1.205290,1.204244,
		1.203198,1.202152,1.201105,1.200057,1.199009,1.197961,1.196912,1.195863,
		1.194813,1.193763,1.192712,1.191661,1.190610,1.189558,1.188506,1.187453,
		1.186400,1.185346,1.184292,1.183237,1.182182,1.181127,1.180071,1.179014,
		1.177958,1.176900,1.175842,1.174784,1.173725,1.172666,1.171607,1.170547,
		1.169486,1.168425,1.167363,1.166301,1.165239,1.164176,1.163112,1.162048,
		1.160984,1.159919,1.158853,1.157787,1.156721,1.155654,1.154586,1.153518,
		1.152450,1.151381,1.150311,1.149241,1.148171,1.147100,1.146028,1.144956,
		1.143884,1.142811,1.141737,1.140663,1.139588,1.138513,1.137437,1.136361,
		1.135284,1.134207,1.133129,1.132050,1.130971,1.129892,1.128811,1.127731,
		1.126650,1.125568,1.124486,1.123403,1.122319,1.121235,1.120151,1.119065,
		1.117980,1.116893,1.115807,1.114719,1.113631,1.112543,1.111453,1.110363,
		1.109273,1.108182,1.107091,1.105998,1.104906,1.103812,1.102718,1.101624,
		1.100529,1.099433,1.098336,1.097239,1.096142,1.095044,1.093945,1.092845,
		1.091745,1.090644,1.089543,1.088441,1.087338,1.086235,1.085131,1.084026,
		1.082921,1.081815,1.080709,1.079602,1.078494,1.077385,1.076276,1.075166,
		1.074056,1.072945,1.071833,1.070720,1.069607,1.068493,1.067379,1.066264,
		1.065148,1.064031,1.062914,1.061796,1.060677,1.059558,1.058438,1.057317,
		1.056195,1.055073,1.053950,1.052827,1.051702,1.050577,1.049451,1.048325,
		1.047198,1.046070,1.044941,1.043811,1.042681,1.041550,1.040418,1.039286,
		1.038153,1.037019,1.035884,1.034748,1.033612,1.032475,1.031337,1.030199,
		1.029059,1.027919,1.026778,1.025637,1.024494,1.023351,1.022207,1.021062,
		1.019916,1.018770,1.017622,1.016474,1.015325,1.014175,1.013025,1.011873,
		1.010721,1.009568,1.008414,1.007259,1.006104,1.004947,1.003790,1.002632,
		1.001473,1.000313,0.999152,0.997990,0.996828,0.995665,0.994500,0.993335,
		0.992169,0.991002,0.989835,0.988666,0.987496,0.986326,0.985155,0.983982,
		0.982809,0.981635,0.980460,0.979284,0.978107,0.976929,0.975750,0.974571,
		0.973390,0.972208,0.971026,0.969842,0.968658,0.967472,0.966286,0.965098,
		0.963910,0.962721,0.961530,0.960339,0.959147,0.957953,0.956759,0.955564,
		0.954367,0.953170,0.951972,0.950772,0.949572,0.948370,0.947168,0.945964,
		0.944760,0.943554,0.942348,0.941140,0.939931,0.938721,0.937510,0.936298,
		0.935085,0.933871,0.932656,0.931439,0.930222,0.929003,0.927783,0.926563,
		0.925341,0.924118,0.922893,0.921668,0.920442,0.919214,0.917985,0.916755,
		0.915524,0.914292,0.913059,0.911824,0.910588,0.909351,0.908113,0.906874,
		0.905633,0.904391,0.903148,0.901904,0.900659,0.899412,0.898164,0.896915,
		0.895665,0.894413,0.893160,0.891906,0.890651,0.889394,0.888136,0.886877,
		0.885616,0.884354,0.883091,0.881827,0.880561,0.879294,0.878025,0.876756,
		0.875484,0.874212,0.872938,0.871663,0.870386,0.869108,0.867829,0.866548,
		0.865266,0.863983,0.862698,0.861411,0.860124,0.858834,0.857544,0.856252,
		0.854958,0.853663,0.852367,0.851069,0.849770,0.848469,0.847166,0.845862,
		0.844557,0.843250,0.841942,0.840632,0.839320,0.838007,0.836693,0.835377,
		0.834059,0.832740,0.831419,0.830096,0.828772,0.827447,0.826119,0.824790,
		0.823460,0.822128,0.820794,0.819458,0.818121,0.816782,0.815442,0.814099,
		0.812756,0.811410,0.810063,0.808713,0.807363,0.806010,0.804656,0.803300,
		0.801942,0.800582,0.799221,0.797857,0.796492,0.795125,0.793757,0.792386,
		0.791014,0.789639,0.788263,0.786885,0.785505,0.784123,0.782739,0.781354,
		0.779966,0.778576,0.777185,0.775791,0.774396,0.772998,0.771599,0.770197,
		0.768794,0.767388,0.765980,0.764571,0.763159,0.761745,0.760329,0.758911,
		0.757491,0.756068,0.754644,0.753217,0.751788,0.750357,0.748924,0.747489,
		0.746051,0.744611,0.743169,0.741724,0.740278,0.738829,0.737377,0.735924,
		0.734468,0.733010,0.731549,0.730086,0.728620,0.727152,0.725682,0.724209,
		0.722734,0.721257,0.719776,0.718294,0.716809,0.715321,0.713831,0.712338,
		0.710842,0.709344,0.707844,0.706340,0.704835,0.703326,0.701815,0.700301,
		0.698784,0.697265,0.695742,0.694217,0.692690,0.691159,0.689625,0.688089,
		0.686550,0.685008,0.683463,0.681915,0.680364,0.678810,0.677253,0.675693,
		0.674130,0.672565,0.670995,0.669423,0.667848,0.666269,0.664688,0.663103,
		0.661515,0.659924,0.658329,0.656731,0.655130,0.653525,0.651918,0.650306,
		0.648692,0.647073,0.645452,0.643827,0.642198,0.640566,0.638930,0.637290,
		0.635647,0.634001,0.632350,0.630696,0.629038,0.627377,0.625711,0.624042,
		0.622369,0.620691,0.619010,0.617325,0.615636,0.613943,0.612246,0.610545,
		0.608839,0.607130,0.605416,0.603698,0.601975,0.600248,0.598517,0.596782,
		0.595042,0.593297,0.591549,0.589795,0.588037,0.586274,0.584507,0.582735,
		0.580958,0.579176,0.577389,0.575598,0.573801,0.571999,0.570193,0.568381,
		0.566564,0.564742,0.562915,0.561082,0.559244,0.557401,0.555552,0.553698,
		0.551838,0.549972,0.548101,0.546224,0.544341,0.542452,0.540558,0.538657,
		0.536750,0.534837,0.532918,0.530993,0.529061,0.527123,0.525179,0.523228,
		0.521270,0.519305,0.517334,0.515356,0.513371,0.511379,0.509380,0.507374,
		0.505360,0.503340,0.501311,0.499275,0.497232,0.495181,0.493122,0.491055,
		0.488980,0.486897,0.484805,0.482706,0.480598,0.478481,0.476356,0.474222,
		0.472079,0.469927,0.467765,0.465595,0.463415,0.461225,0.459026,0.456817,
		0.454598,0.452369,0.450130,0.447880,0.445620,0.443349,0.441067,0.438773,
		0.436469,0.434153,0.431826,0.429487,0.427135,0.424772,0.422396,0.420007,
		0.417606,0.415192,0.412764,0.410323,0.407868,0.405398,0.402915,0.400417,
		0.397904,0.395377,0.392833,0.390274,0.387699,0.385108,0.382500,0.379875,
		0.377233,0.374573,0.371894,0.369198,0.366482,0.363747,0.360992,0.358217,
		0.355421,0.352604,0.349765,0.346904,0.344021,0.341113,0.338182,0.335226,
		0.332245,0.329238,0.326204,0.323143,0.320053,0.316934,0.313786,0.310606,
		0.307395,0.304151,0.300873,0.297560,0.294211,0.290824,0.287399,0.283934,
		0.280426,0.276876,0.273281,0.269639,0.265948,0.262207,0.258413,0.254563,
		0.250656,0.246688,0.242656,0.238558,0.234390,0.230147,0.225827,0.221423,
		0.216931,0.212347,0.207662,0.202871,0.197965,0.192937,0.187776,0.182470,
		0.177008,0.171373,0.165548,0.159513,0.153243,0.146707,0.139868,0.132680,
		0.125082,0.116994,0.108306,0.098861,0.088417,0.076565,0.062510,0.044198,
		0.000000
	};

	const byte Math::LOG_2[256] = { 
		0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5, 
		6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6, 
		7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7, 
		7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7, 
		8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8, 
		8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8, 
		8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8, 
		8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8 
	}; 

	const unsigned char NOISE_TABLE[256] = {
		151, 160, 137, 91, 90, 15, 131, 13, 201, 95, 96, 53, 194, 233,
		7, 225, 140, 36, 103, 30, 69, 142, 8, 99, 37, 240, 21, 10, 23,
		190, 6, 148, 247, 120, 234, 75, 0, 26, 197, 62, 94, 252, 219,
		203, 117, 35, 11, 32, 57, 177, 33, 88, 237, 149, 56, 87, 174,
		20, 125, 136, 171, 168, 68, 175, 74, 165, 71, 134, 139, 48, 27,
		166, 77, 146, 158, 231, 83, 111, 229, 122, 60, 211, 133, 230,
		220, 105, 92, 41, 55, 46, 245, 40, 244, 102, 143, 54, 65, 25,
		63, 161, 1, 216, 80, 73, 209, 76, 132, 187, 208, 89, 18, 169,
		200, 196, 135, 130, 116, 188, 159, 86, 164, 100, 109, 198, 173,
		186, 3, 64, 52, 217, 226, 250, 124, 123, 5, 202, 38, 147, 118, 
		126, 255, 82, 85, 212, 207, 206, 59, 227, 47, 16, 58, 17, 182,
		189, 28, 42, 223, 183, 170, 213, 119, 248, 152, 2, 44, 154, 163,
		70, 221, 153, 101, 155, 167, 43, 172, 9, 129, 22, 39, 253, 19, 
		98, 108, 110, 79, 113, 224, 232, 178, 185, 112, 104, 218, 246, 
		97, 228, 251, 34, 242, 193, 238, 210, 144, 12, 191, 179, 162, 
		241, 81, 51, 145, 235, 249, 14, 239, 107, 49, 192, 214, 31, 181,
		199, 106, 157, 184, 84, 204, 176, 115, 121, 50, 45, 127, 4, 150, 
		254, 138, 236, 205, 93, 222, 114, 67, 29, 24, 72, 243, 141, 128, 
		195, 78, 66, 215, 61, 156, 180
	};

	float NOISE_VECTOR2_TABLE[256 * 2] = {
		0.000000,1.000000,0.024541,0.999699,0.049068,0.998795,0.073565,0.997290,
		0.098017,0.995185,0.122411,0.992480,0.146730,0.989177,0.170962,0.985278,
		0.195090,0.980785,0.219101,0.975702,0.242980,0.970031,0.266713,0.963776,
		0.290285,0.956940,0.313682,0.949528,0.336890,0.941544,0.359895,0.932993,
		0.382683,0.923880,0.405241,0.914210,0.427555,0.903989,0.449611,0.893224,
		0.471397,0.881921,0.492898,0.870087,0.514103,0.857729,0.534998,0.844854,
		0.555570,0.831470,0.575808,0.817585,0.595699,0.803208,0.615232,0.788346,
		0.634393,0.773010,0.653173,0.757209,0.671559,0.740951,0.689541,0.724247,
		0.707107,0.707107,0.724247,0.689541,0.740951,0.671559,0.757209,0.653173,
		0.773010,0.634393,0.788346,0.615232,0.803208,0.595699,0.817585,0.575808,
		0.831470,0.555570,0.844854,0.534998,0.857729,0.514103,0.870087,0.492898,
		0.881921,0.471397,0.893224,0.449611,0.903989,0.427555,0.914210,0.405241,
		0.923880,0.382683,0.932993,0.359895,0.941544,0.336890,0.949528,0.313682,
		0.956940,0.290285,0.963776,0.266713,0.970031,0.242980,0.975702,0.219101,
		0.980785,0.195090,0.985278,0.170962,0.989177,0.146730,0.992480,0.122411,
		0.995185,0.098017,0.997290,0.073564,0.998795,0.049068,0.999699,0.024541,
		1.000000,-0.000000,0.999699,-0.024541,0.998795,-0.049068,0.997290,-0.073565,
		0.995185,-0.098017,0.992480,-0.122411,0.989177,-0.146731,0.985278,-0.170962,
		0.980785,-0.195090,0.975702,-0.219101,0.970031,-0.242980,0.963776,-0.266713,
		0.956940,-0.290285,0.949528,-0.313682,0.941544,-0.336890,0.932993,-0.359895,
		0.923880,-0.382684,0.914210,-0.405241,0.903989,-0.427555,0.893224,-0.449611,
		0.881921,-0.471397,0.870087,-0.492898,0.857729,-0.514103,0.844854,-0.534998,
		0.831470,-0.555570,0.817585,-0.575808,0.803208,-0.595699,0.788346,-0.615232,
		0.773010,-0.634393,0.757209,-0.653173,0.740951,-0.671559,0.724247,-0.689541,
		0.707107,-0.707107,0.689541,-0.724247,0.671559,-0.740951,0.653173,-0.757209,
		0.634393,-0.773010,0.615232,-0.788346,0.595699,-0.803208,0.575808,-0.817585,
		0.555570,-0.831470,0.534997,-0.844854,0.514103,-0.857729,0.492898,-0.870087,
		0.471397,-0.881921,0.449611,-0.893224,0.427555,-0.903989,0.405241,-0.914210,
		0.382683,-0.923880,0.359895,-0.932993,0.336890,-0.941544,0.313682,-0.949528,
		0.290285,-0.956940,0.266713,-0.963776,0.242980,-0.970031,0.219101,-0.975702,
		0.195090,-0.980785,0.170962,-0.985278,0.146730,-0.989177,0.122411,-0.992480,
		0.098017,-0.995185,0.073564,-0.997290,0.049067,-0.998795,0.024541,-0.999699,
		-0.000000,-1.000000,-0.024541,-0.999699,-0.049068,-0.998795,-0.073565,-0.997290,
		-0.098017,-0.995185,-0.122411,-0.992480,-0.146730,-0.989177,-0.170962,-0.985278,
		-0.195090,-0.980785,-0.219101,-0.975702,-0.242980,-0.970031,-0.266713,-0.963776,
		-0.290285,-0.956940,-0.313682,-0.949528,-0.336890,-0.941544,-0.359895,-0.932993,
		-0.382683,-0.923880,-0.405241,-0.914210,-0.427555,-0.903989,-0.449612,-0.893224,
		-0.471397,-0.881921,-0.492898,-0.870087,-0.514103,-0.857729,-0.534998,-0.844854,
		-0.555570,-0.831470,-0.575808,-0.817585,-0.595699,-0.803208,-0.615232,-0.788346,
		-0.634393,-0.773010,-0.653173,-0.757209,-0.671559,-0.740951,-0.689541,-0.724247,
		-0.707107,-0.707107,-0.724247,-0.689541,-0.740951,-0.671559,-0.757209,-0.653173,
		-0.773010,-0.634393,-0.788346,-0.615232,-0.803208,-0.595699,-0.817585,-0.575808,
		-0.831470,-0.555570,-0.844854,-0.534997,-0.857729,-0.514103,-0.870087,-0.492898,
		-0.881921,-0.471397,-0.893224,-0.449611,-0.903989,-0.427555,-0.914210,-0.405241,
		-0.923880,-0.382683,-0.932993,-0.359895,-0.941544,-0.336890,-0.949528,-0.313682,
		-0.956940,-0.290285,-0.963776,-0.266713,-0.970031,-0.242980,-0.975702,-0.219101,
		-0.980785,-0.195090,-0.985278,-0.170962,-0.989177,-0.146730,-0.992480,-0.122411,
		-0.995185,-0.098017,-0.997290,-0.073564,-0.998795,-0.049067,-0.999699,-0.024541,
		-1.000000,0.000000,-0.999699,0.024541,-0.998795,0.049068,-0.997290,0.073565,
		-0.995185,0.098017,-0.992480,0.122411,-0.989177,0.146730,-0.985278,0.170962,
		-0.980785,0.195090,-0.975702,0.219101,-0.970031,0.242980,-0.963776,0.266713,
		-0.956940,0.290285,-0.949528,0.313682,-0.941544,0.336890,-0.932993,0.359895,
		-0.923879,0.382684,-0.914210,0.405242,-0.903989,0.427555,-0.893224,0.449612,
		-0.881921,0.471397,-0.870087,0.492898,-0.857729,0.514103,-0.844853,0.534998,
		-0.831469,0.555570,-0.817585,0.575808,-0.803208,0.595699,-0.788346,0.615232,
		-0.773010,0.634393,-0.757209,0.653173,-0.740951,0.671559,-0.724247,0.689541,
		-0.707107,0.707107,-0.689541,0.724247,-0.671559,0.740951,-0.653173,0.757209,
		-0.634393,0.773011,-0.615231,0.788347,-0.595699,0.803208,-0.575808,0.817585,
		-0.555570,0.831470,-0.534998,0.844854,-0.514103,0.857729,-0.492898,0.870087,
		-0.471397,0.881921,-0.449611,0.893224,-0.427555,0.903989,-0.405241,0.914210,
		-0.382683,0.923880,-0.359895,0.932993,-0.336890,0.941544,-0.313682,0.949528,
		-0.290284,0.956940,-0.266712,0.963776,-0.242980,0.970031,-0.219101,0.975702,
		-0.195090,0.980785,-0.170962,0.985278,-0.146730,0.989177,-0.122410,0.992480,
		-0.098017,0.995185,-0.073565,0.997290,-0.049068,0.998795,-0.024541,0.999699
	};

	//
	void math_write_tables()
	{
		FILE * fpSin = fopen("sin.text", "wb");
		FILE * fpCos = fopen("cos.text", "wb");
		FILE * fpACos = fopen("acos.text", "wb");
		FILE * fpNoise = fopen("noise.text", "wb");

		static float SIN_TABLE[TRI_TABLE_SIZE + 1];
		static float COS_TABLE[TRI_TABLE_SIZE + 1];
		static float ACOS_TABLE[TRI_TABLE_SIZE + 1];
		float NOISE_VECTOR2_TABLE[256 * 2];

		float rads = 0.0f;
		float acosine = -1.0f;
		for (int i = 0; i < TRI_TABLE_SIZE + 1; i++)
		{
			rads = PI2 * i / TRI_TABLE_SIZE;

			SIN_TABLE[i] = Math::Sin(rads);
			COS_TABLE[i] = Math::Cos(rads);

			acosine = -1.0f + 2.0f * i / TRI_TABLE_SIZE;
			ACOS_TABLE[i] = Math::ACos(acosine);
		}

		rads = 0.0f;
		for (int i = 0; i < 256; i++)
		{
			rads = i * PI2 / 256.0f;

			NOISE_VECTOR2_TABLE[i * 2 + 0] = Math::Sin(rads);
			NOISE_VECTOR2_TABLE[i * 2 + 1] = Math::Cos(rads);
		}

		for (int i = 0; i < TRI_TABLE_SIZE + 1; ++i)
		{
			if ((i & 7) == 0)
			{
				fprintf(fpSin, "\n");
				fprintf(fpCos, "\n");
				fprintf(fpACos, "\n");
			}

			fprintf(fpSin, "%f,", SIN_TABLE[i]);
			fprintf(fpCos, "%f,", COS_TABLE[i]);
			fprintf(fpACos, "%f,", ACOS_TABLE[i]);
		}

		for (int i = 0; i < 256; ++i)
		{
			if ((i & 3) == 0)
			{
				fprintf(fpNoise, "\n");
			}

			fprintf(fpNoise, "%f,", NOISE_VECTOR2_TABLE[i * 2 + 0]);
			fprintf(fpNoise, "%f,", NOISE_VECTOR2_TABLE[i * 2 + 1]);
		}

		fclose(fpSin);
		fclose(fpCos);
		fclose(fpACos);
		fclose(fpNoise);
	}

	void Math::Init()
	{
		srand((unsigned int)time(NULL));
	}

	void Math::Shutdown()
	{
	}

	unsigned short Math::Crc16(const char * str, int len)
	{
		static unsigned short CRC16_TABLE[256] = {
			0x0000, 0x1021, 0x2042, 0x3063, 0x4084, 0x50A5, 0x60C6, 0x70E7,
			0x8108, 0x9129, 0xA14A, 0xB16B, 0xC18C, 0xD1AD, 0xE1CE, 0xF1EF,
			0x1231, 0x0210, 0x3273, 0x2252, 0x52B5, 0x4294, 0x72F7, 0x62D6,
			0x9339, 0x8318, 0xB37B, 0xA35A, 0xD3BD, 0xC39C, 0xF3FF, 0xE3DE,
			0x2462, 0x3443, 0x0420, 0x1401, 0x64E6, 0x74C7, 0x44A4, 0x5485,
			0xA56A, 0xB54B, 0x8528, 0x9509, 0xE5EE, 0xF5CF, 0xC5AC, 0xD58D,
			0x3653, 0x2672, 0x1611, 0x0630, 0x76D7, 0x66F6, 0x5695, 0x46B4,
			0xB75B, 0xA77A, 0x9719, 0x8738, 0xF7DF, 0xE7FE, 0xD79D, 0xC7BC,
			0x48C4, 0x58E5, 0x6886, 0x78A7, 0x0840, 0x1861, 0x2802, 0x3823,
			0xC9CC, 0xD9ED, 0xE98E, 0xF9AF, 0x8948, 0x9969, 0xA90A, 0xB92B,
			0x5AF5, 0x4AD4, 0x7AB7, 0x6A96, 0x1A71, 0x0A50, 0x3A33, 0x2A12,
			0xDBFD, 0xCBDC, 0xFBBF, 0xEB9E, 0x9B79, 0x8B58, 0xBB3B, 0xAB1A,
			0x6CA6, 0x7C87, 0x4CE4, 0x5CC5, 0x2C22, 0x3C03, 0x0C60, 0x1C41,
			0xEDAE, 0xFD8F, 0xCDEC, 0xDDCD, 0xAD2A, 0xBD0B, 0x8D68, 0x9D49,
			0x7E97, 0x6EB6, 0x5ED5, 0x4EF4, 0x3E13, 0x2E32, 0x1E51, 0x0E70,
			0xFF9F, 0xEFBE, 0xDFDD, 0xCFFC, 0xBF1B, 0xAF3A, 0x9F59, 0x8F78,
			0x9188, 0x81A9, 0xB1CA, 0xA1EB, 0xD10C, 0xC12D, 0xF14E, 0xE16F,
			0x1080, 0x00A1, 0x30C2, 0x20E3, 0x5004, 0x4025, 0x7046, 0x6067,
			0x83B9, 0x9398, 0xA3FB, 0xB3DA, 0xC33D, 0xD31C, 0xE37F, 0xF35E,
			0x02B1, 0x1290, 0x22F3, 0x32D2, 0x4235, 0x5214, 0x6277, 0x7256,
			0xB5EA, 0xA5CB, 0x95A8, 0x8589, 0xF56E, 0xE54F, 0xD52C, 0xC50D,
			0x34E2, 0x24C3, 0x14A0, 0x0481, 0x7466, 0x6447, 0x5424, 0x4405,
			0xA7DB, 0xB7FA, 0x8799, 0x97B8, 0xE75F, 0xF77E, 0xC71D, 0xD73C,
			0x26D3, 0x36F2, 0x0691, 0x16B0, 0x6657, 0x7676, 0x4615, 0x5634,
			0xD94C, 0xC96D, 0xF90E, 0xE92F, 0x99C8, 0x89E9, 0xB98A, 0xA9AB,
			0x5844, 0x4865, 0x7806, 0x6827, 0x18C0, 0x08E1, 0x3882, 0x28A3,
			0xCB7D, 0xDB5C, 0xEB3F, 0xFB1E, 0x8BF9, 0x9BD8, 0xABBB, 0xBB9A,
			0x4A75, 0x5A54, 0x6A37, 0x7A16, 0x0AF1, 0x1AD0, 0x2AB3, 0x3A92,
			0xFD2E, 0xED0F, 0xDD6C, 0xCD4D, 0xBDAA, 0xAD8B, 0x9DE8, 0x8DC9,
			0x7C26, 0x6C07, 0x5C64, 0x4C45, 0x3CA2, 0x2C83, 0x1CE0, 0x0CC1,
			0xEF1F, 0xFF3E, 0xCF5D, 0xDF7C, 0xAF9B, 0xBFBA, 0x8FD9, 0x9FF8,
			0x6E17, 0x7E36, 0x4E55, 0x5E74, 0x2E93, 0x3EB2, 0x0ED1, 0x1EF0
		};

		unsigned short crc = 0;

		if (len == 0)
		{
			for (int i = 0; str[i]; ++i)
			{
				crc = CRC16_TABLE[(crc >> 8 ^ str[i]) & 0xFF] ^ (crc << 8);
			}
		}
		else
		{
			for (int i = 0; i < len; ++i)
			{
				crc = CRC16_TABLE[(crc >> 8 ^ str[i]) & 0xFF] ^ (crc << 8);
			}
		}

		return ~crc;
	}

	int Math::Crc32(const char * str, int len)
	{
		static int CRC32_TABLE[256] = 
		{
			0x00000000L, 0x77073096L, 0xee0e612cL, 0x990951baL, 0x076dc419L,
			0x706af48fL, 0xe963a535L, 0x9e6495a3L, 0x0edb8832L, 0x79dcb8a4L,
			0xe0d5e91eL, 0x97d2d988L, 0x09b64c2bL, 0x7eb17cbdL, 0xe7b82d07L,
			0x90bf1d91L, 0x1db71064L, 0x6ab020f2L, 0xf3b97148L, 0x84be41deL,
			0x1adad47dL, 0x6ddde4ebL, 0xf4d4b551L, 0x83d385c7L, 0x136c9856L,
			0x646ba8c0L, 0xfd62f97aL, 0x8a65c9ecL, 0x14015c4fL, 0x63066cd9L,
			0xfa0f3d63L, 0x8d080df5L, 0x3b6e20c8L, 0x4c69105eL, 0xd56041e4L,
			0xa2677172L, 0x3c03e4d1L, 0x4b04d447L, 0xd20d85fdL, 0xa50ab56bL,
			0x35b5a8faL, 0x42b2986cL, 0xdbbbc9d6L, 0xacbcf940L, 0x32d86ce3L,
			0x45df5c75L, 0xdcd60dcfL, 0xabd13d59L, 0x26d930acL, 0x51de003aL,
			0xc8d75180L, 0xbfd06116L, 0x21b4f4b5L, 0x56b3c423L, 0xcfba9599L,
			0xb8bda50fL, 0x2802b89eL, 0x5f058808L, 0xc60cd9b2L, 0xb10be924L,
			0x2f6f7c87L, 0x58684c11L, 0xc1611dabL, 0xb6662d3dL, 0x76dc4190L,
			0x01db7106L, 0x98d220bcL, 0xefd5102aL, 0x71b18589L, 0x06b6b51fL,
			0x9fbfe4a5L, 0xe8b8d433L, 0x7807c9a2L, 0x0f00f934L, 0x9609a88eL,
			0xe10e9818L, 0x7f6a0dbbL, 0x086d3d2dL, 0x91646c97L, 0xe6635c01L,
			0x6b6b51f4L, 0x1c6c6162L, 0x856530d8L, 0xf262004eL, 0x6c0695edL,
			0x1b01a57bL, 0x8208f4c1L, 0xf50fc457L, 0x65b0d9c6L, 0x12b7e950L,
			0x8bbeb8eaL, 0xfcb9887cL, 0x62dd1ddfL, 0x15da2d49L, 0x8cd37cf3L,
			0xfbd44c65L, 0x4db26158L, 0x3ab551ceL, 0xa3bc0074L, 0xd4bb30e2L,
			0x4adfa541L, 0x3dd895d7L, 0xa4d1c46dL, 0xd3d6f4fbL, 0x4369e96aL,
			0x346ed9fcL, 0xad678846L, 0xda60b8d0L, 0x44042d73L, 0x33031de5L,
			0xaa0a4c5fL, 0xdd0d7cc9L, 0x5005713cL, 0x270241aaL, 0xbe0b1010L,
			0xc90c2086L, 0x5768b525L, 0x206f85b3L, 0xb966d409L, 0xce61e49fL,
			0x5edef90eL, 0x29d9c998L, 0xb0d09822L, 0xc7d7a8b4L, 0x59b33d17L,
			0x2eb40d81L, 0xb7bd5c3bL, 0xc0ba6cadL, 0xedb88320L, 0x9abfb3b6L,
			0x03b6e20cL, 0x74b1d29aL, 0xead54739L, 0x9dd277afL, 0x04db2615L,
			0x73dc1683L, 0xe3630b12L, 0x94643b84L, 0x0d6d6a3eL, 0x7a6a5aa8L,
			0xe40ecf0bL, 0x9309ff9dL, 0x0a00ae27L, 0x7d079eb1L, 0xf00f9344L,
			0x8708a3d2L, 0x1e01f268L, 0x6906c2feL, 0xf762575dL, 0x806567cbL,
			0x196c3671L, 0x6e6b06e7L, 0xfed41b76L, 0x89d32be0L, 0x10da7a5aL,
			0x67dd4accL, 0xf9b9df6fL, 0x8ebeeff9L, 0x17b7be43L, 0x60b08ed5L,
			0xd6d6a3e8L, 0xa1d1937eL, 0x38d8c2c4L, 0x4fdff252L, 0xd1bb67f1L,
			0xa6bc5767L, 0x3fb506ddL, 0x48b2364bL, 0xd80d2bdaL, 0xaf0a1b4cL,
			0x36034af6L, 0x41047a60L, 0xdf60efc3L, 0xa867df55L, 0x316e8eefL,
			0x4669be79L, 0xcb61b38cL, 0xbc66831aL, 0x256fd2a0L, 0x5268e236L,
			0xcc0c7795L, 0xbb0b4703L, 0x220216b9L, 0x5505262fL, 0xc5ba3bbeL,
			0xb2bd0b28L, 0x2bb45a92L, 0x5cb36a04L, 0xc2d7ffa7L, 0xb5d0cf31L,
			0x2cd99e8bL, 0x5bdeae1dL, 0x9b64c2b0L, 0xec63f226L, 0x756aa39cL,
			0x026d930aL, 0x9c0906a9L, 0xeb0e363fL, 0x72076785L, 0x05005713L,
			0x95bf4a82L, 0xe2b87a14L, 0x7bb12baeL, 0x0cb61b38L, 0x92d28e9bL,
			0xe5d5be0dL, 0x7cdcefb7L, 0x0bdbdf21L, 0x86d3d2d4L, 0xf1d4e242L,
			0x68ddb3f8L, 0x1fda836eL, 0x81be16cdL, 0xf6b9265bL, 0x6fb077e1L,
			0x18b74777L, 0x88085ae6L, 0xff0f6a70L, 0x66063bcaL, 0x11010b5cL,
			0x8f659effL, 0xf862ae69L, 0x616bffd3L, 0x166ccf45L, 0xa00ae278L,
			0xd70dd2eeL, 0x4e048354L, 0x3903b3c2L, 0xa7672661L, 0xd06016f7L,
			0x4969474dL, 0x3e6e77dbL, 0xaed16a4aL, 0xd9d65adcL, 0x40df0b66L,
			0x37d83bf0L, 0xa9bcae53L, 0xdebb9ec5L, 0x47b2cf7fL, 0x30b5ffe9L,
			0xbdbdf21cL, 0xcabac28aL, 0x53b39330L, 0x24b4a3a6L, 0xbad03605L,
			0xcdd70693L, 0x54de5729L, 0x23d967bfL, 0xb3667a2eL, 0xc4614ab8L,
			0x5d681b02L, 0x2a6f2b94L, 0xb40bbe37L, 0xc30c8ea1L, 0x5a05df1bL,
			0x2d02ef8dL
		};

		long crc = 0;  
		long temp1, temp2;  
		long tmpCRC;

		if (len == 0)
		{
			for (int i = 0; str[i]; ++i)
			{  
				temp1 = (crc >> 8) & 0x00FFFFFFL;  
				tmpCRC = (byte)crc ^ str[i];  

				temp2 = CRC32_TABLE[(int)(tmpCRC & 0x000000FFL)];  
				crc = temp1 ^ temp2;  
			}
		}
		else
		{
			for (int i = 0; i < len; ++i)
			{  
				temp1 = (crc >> 8) & 0x00FFFFFFL;  
				tmpCRC = (byte)crc ^ str[i];  

				temp2 = CRC32_TABLE[(int)(tmpCRC & 0x000000FFL)];  
				crc = temp1 ^ temp2;  
			}
		}

		return crc;
	}

	inline void _getNoise2(Float2 & v, int x, int y)
	{
		unsigned char a = NOISE_TABLE[x & 255];
		unsigned char b = NOISE_TABLE[y & 255];
		unsigned char i = NOISE_TABLE[(a + b) & 255];
		
		v.x = NOISE_VECTOR2_TABLE[i * 2 + 0];
		v.y = NOISE_VECTOR2_TABLE[i * 2 + 1];
	}

	float Math::Noise2(float x, float y)
	{
		 Float2 v(x, y);

		float x0 = (float)::floor(v.x);
		float y0 = (float)::floor(v.y);
		float x1 = x0 + 1.0f;
		float y1 = y0 + 1.0f;

		Float2 v1, v2, v3, v4;
		_getNoise2(v1, (int)x0, (int)y0);
		_getNoise2(v2, (int)x0, (int)y1);
		_getNoise2(v3, (int)x1, (int)y0);
		_getNoise2(v4, (int)x1, (int)y1);

		Float2 d1(v.x - x0, v.y - y0);
		Float2 d2(v.x - x0, v.y - y1);
		Float2 d3(v.x - x1, v.y - y0);
		Float2 d4(v.x - x1, v.y - y1);

		float l1, l2, l3, l4;
		l1 = d1.x * v1.x + d1.y * v1.y;
		l2 = d2.x * v2.x + d2.y * v2.y;
		l3 = d3.x * v3.x + d3.y * v3.y;
		l4 = d4.x * v4.x + d4.y * v4.y;

		// Perlin Function 2 (2002):
		//		w = 6t^5 - 15t^4 + 10t^3
		//
		float sx, sy;

		float x3 = d1.x * d1.x * d1.x;
		float y3 = d1.y * d1.y * d1.y;

		sx = 6.0f * x3 * d1.x * d1.x - 15.0f * x3 * d1.x + 10.0f * x3;
		sy = 6.0f * y3 * d1.y * d1.y - 15.0f * y3 * d1.y + 10.0f * y3;

		float avg0x = l1 + (sx * (l3 - l1));
		float avg1x = l2 + (sx * (l4 - l2));
		float result = avg0x + (sy * (avg1x - avg0x));

		return result;
	}

	template <class T>
	int RLE_EncodeT(T * dest, int d_size, const T * src, int s_size, T C_MAGIC, T C_MAX)
	{
		int i = 0, size = 0;

		while (i < s_size)
		{
			T val = src[i++];

			T j = 1;
			while (val == src[i]  && j < C_MAX)
			{
				++i;
				++j;
			}

			if (size + 2 > d_size)
				return -1;

			if (j > 1)
			{
				dest[size++] = C_MAGIC | j;
				dest[size++] = val;
			}
			else
			{
				if ((val & C_MAGIC) == C_MAGIC)
				{
					dest[size++] = C_MAGIC | 1;
				}

				dest[size++] = val;
			}
		}

		return size;
	}

	template <class T>
	int RLE_DecodeT(T * dest, int d_size, const T * src, int s_size, T C_MAGIC, T C_MAX)
	{
		int i = 0, size = 0;

		while (i < s_size)
		{
			T val = src[i++];

			int count = 1;
			if ((val & C_MAGIC) == C_MAGIC)
			{
				count = val & C_MAX;
				val = src[i++];
			}

			d_assert (count > 0);

			if (size + count > d_size)
				return -1;

			for (int j = 0; j < count; ++j)
			{
				dest[size++] = val;
			}
		}

		return size;
	}

	int Math::RLE8_Encode(byte * dest, int dsize, const byte * src, int ssize)
	{
		return RLE_EncodeT<byte>(dest, dsize, src, ssize, 0xC0, 0x3F);
	}

	int Math::RLE8_Decode(byte * dest, int dsize, const byte * src, int ssize)
	{
		return RLE_DecodeT<byte>(dest, dsize, src, ssize, 0xC0, 0x3F);
	}

	int Math::RLE16_Encode(word * dest, int dsize, const word * src, int ssize)
	{
		return RLE_EncodeT<word>(dest, dsize, src, ssize, 0xFF00, 0x00FF);
	}

	int Math::RLE16_Decode(word * dest, int dsize, const word * src, int ssize)
	{
		return RLE_DecodeT<word>(dest, dsize, src, ssize, 0xFF00, 0x00FF);
	}

	int Math::RLE32_Encode(dword * dest, int dsize, const dword * src, int ssize)
	{
		return RLE_EncodeT<dword>(dest, dsize, src, ssize, 0xFFFF0000, 0x0000FFFF);
	}

	int Math::RLE32_Decode(dword * dest, int dsize, const dword * src, int ssize)
	{
		return RLE_DecodeT<dword>(dest, dsize, src, ssize, 0xFFFF0000, 0x0000FFFF);
	}

}


#ifdef _MSC_VER
#pragma warning(pop)
#endif